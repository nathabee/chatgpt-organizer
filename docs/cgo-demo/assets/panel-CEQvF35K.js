function Bi(){function e(Ue,Zi){if(!Ue)throw new Error(`[dom] Missing #${Zi}`);return Ue}const t=e(document.getElementById("cgoRoot"),"cgoRoot"),i=e(document.getElementById("scopeLabel"),"scopeLabel"),n=e(document.getElementById("btnScopeChange"),"btnScopeChange"),s=e(document.getElementById("btnScopeRefresh"),"btnScopeRefresh"),r=e(document.getElementById("scopeDialog"),"scopeDialog"),a=e(document.getElementById("scopeDate"),"scopeDate"),l=e(document.getElementById("btnScopeCancel"),"btnScopeCancel"),u=e(document.getElementById("btnScopeApply"),"btnScopeApply"),P=e(document.getElementById("scopeLoadedSingles"),"scopeLoadedSingles"),b=e(document.getElementById("scopeLoadedProjects"),"scopeLoadedProjects"),c=e(document.getElementById("scopeLoadedProjectChats"),"scopeLoadedProjectChats"),d=e(document.querySelector(".scopeLoading"),"scopeLoading"),p=e(document.getElementById("btnListSingle"),"btnListSingle"),o=e(document.getElementById("btnListProjects"),"btnListProjects"),T=e(document.getElementById("tabSingle"),"tabSingle"),m=e(document.getElementById("tabProjects"),"tabProjects"),f=e(document.getElementById("tabOrganize"),"tabOrganize"),y=e(document.getElementById("tabSearch"),"tabSearch"),I=e(document.getElementById("tabSettings"),"tabSettings"),S=e(document.getElementById("tabLogs"),"tabLogs"),C=e(document.getElementById("tabStats"),"tabStats"),g=e(document.getElementById("viewSingle"),"viewSingle"),j=e(document.getElementById("viewProjects"),"viewProjects"),v=e(document.getElementById("viewOrganize"),"viewOrganize"),z=e(document.getElementById("viewSearch"),"viewSearch"),h=e(document.getElementById("viewSettings"),"viewSettings"),x=e(document.getElementById("viewLogs"),"viewLogs"),E=e(document.getElementById("viewStats"),"viewStats"),w=e(document.getElementById("searchQuery"),"searchQuery"),k=e(document.getElementById("btnSearchClear"),"btnSearchClear"),L=e(document.getElementById("btnSearchResetFilters"),"btnSearchResetFilters"),O=e(document.getElementById("searchScope"),"searchScope"),$=e(document.getElementById("searchArchived"),"searchArchived"),A=e(document.getElementById("searchUpdatedWithin"),"searchUpdatedWithin"),R=e(document.getElementById("searchCreatedWithin"),"searchCreatedWithin"),N=e(document.getElementById("searchUpdatedAfter"),"searchUpdatedAfter"),J=e(document.getElementById("searchUpdatedBefore"),"searchUpdatedBefore"),G=e(document.getElementById("searchCreatedAfter"),"searchCreatedAfter"),Y=e(document.getElementById("searchCreatedBefore"),"searchCreatedBefore"),K=e(document.getElementById("searchInfoBox"),"searchInfoBox"),V=e(document.getElementById("btnSearchListSingle"),"btnSearchListSingle"),X=e(document.getElementById("btnSearchListProjects"),"btnSearchListProjects"),Tt=e(document.getElementById("searchLoadedSingles"),"searchLoadedSingles"),Et=e(document.getElementById("searchLoadedProjects"),"searchLoadedProjects"),Ct=e(document.getElementById("searchLoadedProjectChats"),"searchLoadedProjectChats"),St=e(document.getElementById("searchInfoLimits"),"searchInfoLimits"),bt=e(document.getElementById("searchStatus"),"searchStatus"),vt=e(document.getElementById("searchResultsCount"),"searchResultsCount"),yt=e(document.getElementById("searchResults"),"searchResults"),jt=e(document.getElementById("singleLimit"),"singleLimit"),It=e(document.getElementById("singleStatus"),"singleStatus"),Pt=e(document.getElementById("cbSingleToggleAll"),"cbSingleToggleAll"),xt=e(document.getElementById("btnSingleDelete"),"btnSingleDelete"),Lt=e(document.getElementById("singleExecOut"),"singleExecOut"),wt=e(document.getElementById("singleExecProgressWrap"),"singleExecProgressWrap"),zt=e(document.getElementById("singleExecProgress"),"singleExecProgress"),kt=e(document.getElementById("singleExecProgressText"),"singleExecProgressText"),Ot=e(document.getElementById("singleConfirmBox"),"singleConfirmBox"),Dt=e(document.getElementById("singleConfirmTitle"),"singleConfirmTitle"),Zt=e(document.getElementById("singleConfirmPreview"),"singleConfirmPreview"),Bt=e(document.getElementById("singleCbConfirm"),"singleCbConfirm"),At=e(document.getElementById("singleBtnConfirmExecute"),"singleBtnConfirmExecute"),$t=e(document.getElementById("singleBtnCancelExecute"),"singleBtnCancelExecute"),Rt=e(document.getElementById("singleCount"),"singleCount"),Mt=e(document.getElementById("singleSelectedCount"),"singleSelectedCount"),_t=e(document.getElementById("singleList"),"singleList"),Nt=e(document.getElementById("projectsLimit"),"projectsLimit"),Ut=e(document.getElementById("projectsChatsLimit"),"projectsChatsLimit"),Ht=e(document.getElementById("projectsStatus"),"projectsStatus"),Gt=e(document.getElementById("btnProjectsDelete"),"btnProjectsDelete"),Ft=e(document.getElementById("projectsExecOut"),"projectsExecOut"),Jt=e(document.getElementById("projectsChatsExecProgressWrap"),"projectsChatsExecProgressWrap"),Vt=e(document.getElementById("projectsChatsExecProgress"),"projectsChatsExecProgress"),Wt=e(document.getElementById("projectsChatsExecProgressText"),"projectsChatsExecProgressText"),Kt=e(document.getElementById("projectsProjectsExecProgressWrap"),"projectsProjectsExecProgressWrap"),Xt=e(document.getElementById("projectsProjectsExecProgress"),"projectsProjectsExecProgress"),Yt=e(document.getElementById("projectsProjectsExecProgressText"),"projectsProjectsExecProgressText"),Qt=e(document.getElementById("projectsConfirmBox"),"projectsConfirmBox"),qt=e(document.getElementById("projectsConfirmTitle"),"projectsConfirmTitle"),en=e(document.getElementById("projectsConfirmPreview"),"projectsConfirmPreview"),tn=e(document.getElementById("projectsCbConfirm"),"projectsCbConfirm"),nn=e(document.getElementById("projectsBtnConfirmExecute"),"projectsBtnConfirmExecute"),sn=e(document.getElementById("projectsBtnCancelExecute"),"projectsBtnCancelExecute"),cn=e(document.getElementById("projectsCount"),"projectsCount"),on=e(document.getElementById("projectsChatsCount"),"projectsChatsCount"),an=e(document.getElementById("projectsSelectedChatsCount"),"projectsSelectedChatsCount"),rn=e(document.getElementById("projectsSelectedProjectsCount"),"projectsSelectedProjectsCount"),ln=e(document.getElementById("projectsList"),"projectsList"),dn=e(document.getElementById("mountCreateProjectProjects"),"mountCreateProjectProjects"),un=e(document.getElementById("mountCreateProjectOrganize"),"mountCreateProjectOrganize"),gn=e(document.getElementById("logsLimit"),"logsLimit"),pn=e(document.getElementById("btnLogsRefresh"),"btnLogsRefresh"),mn=e(document.getElementById("logsStatus"),"logsStatus"),hn=e(document.getElementById("logsTrimKeep"),"logsTrimKeep"),fn=e(document.getElementById("btnLogsTrim"),"btnLogsTrim"),Tn=e(document.getElementById("btnLogsExport"),"btnLogsExport"),En=e(document.getElementById("btnLogsClear"),"btnLogsClear"),Cn=e(document.getElementById("logsOut"),"logsOut"),Sn=e(document.getElementById("cfgShowDevTools"),"cfgShowDevTools"),bn=e(document.getElementById("settingsGeneralStatus"),"settingsGeneralStatus"),vn=e(document.getElementById("apiOrigin"),"apiOrigin"),yn=e(document.getElementById("btnApiOriginReset"),"btnApiOriginReset"),jn=e(document.getElementById("apiOriginStatus"),"apiOriginStatus"),In=e(document.getElementById("settingsVersion"),"settingsVersion"),Pn=e(document.getElementById("settingsGitHubLink"),"settingsGitHubLink"),xn=e(document.getElementById("devConfigDetails"),"devConfigDetails"),Ln=e(document.getElementById("settingsConnectionBox"),"settingsConnectionBox"),wn=e(document.getElementById("cfgTraceScope"),"cfgTraceScope"),zn=e(document.getElementById("cfgStopAfterOutOfScope"),"cfgStopAfterOutOfScope"),kn=e(document.getElementById("btnCfgResetDefaults"),"btnCfgResetDefaults"),On=e(document.getElementById("cfgStatus"),"cfgStatus"),Dn=e(document.getElementById("cfgActionLogMax"),"cfgActionLogMax"),Zn=e(document.getElementById("cfgDebugTraceMax"),"cfgDebugTraceMax"),Bn=e(document.getElementById("cfgFailureLogsPerRun"),"cfgFailureLogsPerRun"),An=e(document.getElementById("logsCbDebug"),"logsCbDebug"),$n=e(document.getElementById("debugLimit"),"debugLimit"),Rn=e(document.getElementById("btnDebugRefresh"),"btnDebugRefresh"),Mn=e(document.getElementById("btnDebugExport"),"btnDebugExport"),_n=e(document.getElementById("btnDebugClear"),"btnDebugClear"),Nn=e(document.getElementById("debugStatus"),"debugStatus"),Un=e(document.getElementById("debugOut"),"debugOut"),Hn=e(document.getElementById("btnStatsRecalc"),"btnStatsRecalc"),Gn=e(document.getElementById("statsStatus"),"statsStatus"),Fn=e(document.getElementById("statsLastCacheUpdate"),"statsLastCacheUpdate"),Jn=e(document.getElementById("statsSnapshotBox"),"statsSnapshotBox"),Vn=e(document.getElementById("statsSingleChats"),"statsSingleChats"),Wn=e(document.getElementById("statsProjects"),"statsProjects"),Kn=e(document.getElementById("statsProjectChats"),"statsProjectChats"),Xn=e(document.getElementById("statsTotalChats"),"statsTotalChats"),Yn=e(document.getElementById("statsArchivedChats"),"statsArchivedChats"),Qn=e(document.getElementById("statsAvgChatsPerProject"),"statsAvgChatsPerProject"),qn=e(document.getElementById("statsLimitsHint"),"statsLimitsHint"),ei=e(document.getElementById("statsActivityBox"),"statsActivityBox"),ti=e(document.getElementById("statsActivityExplain"),"statsActivityExplain"),ni=e(document.getElementById("statsCreatedHeatmap"),"statsCreatedHeatmap"),ii=e(document.getElementById("statsLifetimeHist"),"statsLifetimeHist"),si=e(document.getElementById("statsProjectsBox"),"statsProjectsBox"),ci=e(document.getElementById("statsProjectSizeHist"),"statsProjectSizeHist"),oi=e(document.getElementById("statsTopProjects"),"statsTopProjects"),ai=e(document.getElementById("statsDeletesBox"),"statsDeletesBox"),ri=e(document.getElementById("statsDeletedChats"),"statsDeletedChats"),li=e(document.getElementById("statsDeletedProjects"),"statsDeletedProjects"),di=e(document.getElementById("organizeSource"),"organizeSource"),ui=e(document.getElementById("organizeFilter"),"organizeFilter"),gi=e(document.getElementById("cbOrganizeToggleAll"),"cbOrganizeToggleAll"),pi=e(document.getElementById("organizeSourceStatus"),"organizeSourceStatus"),mi=e(document.getElementById("organizeSourceCount"),"organizeSourceCount"),hi=e(document.getElementById("organizeSelectedCount"),"organizeSelectedCount"),fi=e(document.getElementById("organizeSourceList"),"organizeSourceList"),Ti=e(document.getElementById("organizeProjectFilter"),"organizeProjectFilter"),Ei=e(document.getElementById("btnOrganizeClearTarget"),"btnOrganizeClearTarget"),Ci=e(document.getElementById("organizeProjectsStatus"),"organizeProjectsStatus"),Si=e(document.getElementById("organizeProjectsCount"),"organizeProjectsCount"),bi=e(document.getElementById("organizeTargetLabel"),"organizeTargetLabel"),vi=e(document.getElementById("organizeProjectList"),"organizeProjectList"),yi=e(document.getElementById("btnOrganizeMove"),"btnOrganizeMove"),ji=e(document.getElementById("organizeExecOut"),"organizeExecOut"),Ii=e(document.getElementById("organizeExecProgressWrap"),"organizeExecProgressWrap"),Pi=e(document.getElementById("organizeExecProgress"),"organizeExecProgress"),xi=e(document.getElementById("organizeExecProgressText"),"organizeExecProgressText"),Li=e(document.getElementById("organizeConfirmBox"),"organizeConfirmBox"),wi=e(document.getElementById("organizeConfirmTitle"),"organizeConfirmTitle"),zi=e(document.getElementById("organizeConfirmPreview"),"organizeConfirmPreview"),ki=e(document.getElementById("organizeCbConfirm"),"organizeCbConfirm"),Oi=e(document.getElementById("organizeBtnConfirmExecute"),"organizeBtnConfirmExecute"),Di=e(document.getElementById("organizeBtnCancelExecute"),"organizeBtnCancelExecute");return{rootEl:t,tabSingle:T,tabProjects:m,tabOrganize:f,tabSearch:y,tabSettings:I,tabLogs:S,tabStats:C,viewSingle:g,viewProjects:j,viewOrganize:v,viewSearch:z,viewSettings:h,viewLogs:x,viewStats:E,scopeLabelEl:i,btnScopeChange:n,btnScopeRefresh:s,scopeDialogEl:r,scopeDateEl:a,btnScopeCancel:l,btnScopeApply:u,scopeLoadedSinglesEl:P,scopeLoadedProjectsEl:b,scopeLoadedProjectChatsEl:c,scopeLoadingEl:d,btnListSingle:p,btnListProjects:o,searchInfoBoxEl:K,btnSearchListSingle:V,btnSearchListProjects:X,searchLoadedSinglesEl:Tt,searchLoadedProjectsEl:Et,searchLoadedProjectChatsEl:Ct,searchInfoLimitsEl:St,btnSearchResetFilters:L,searchStatusEl:bt,searchQueryEl:w,btnSearchClear:k,searchScopeEl:O,searchArchivedEl:$,searchUpdatedWithinEl:A,searchUpdatedAfterEl:N,searchUpdatedBeforeEl:J,searchCreatedWithinEl:R,searchCreatedAfterEl:G,searchCreatedBeforeEl:Y,searchResultsCountEl:vt,searchResultsEl:yt,singleLimitEl:jt,singleStatusEl:It,cbSingleToggleAll:Pt,btnSingleDelete:xt,singleExecOutEl:Lt,singleExecProgressWrapEl:wt,singleExecProgressEl:zt,singleExecProgressTextEl:kt,singleConfirmBoxEl:Ot,singleConfirmTitleEl:Dt,singleConfirmPreviewEl:Zt,singleCbConfirmEl:Bt,singleBtnConfirmExecute:At,singleBtnCancelExecute:$t,singleCountEl:Rt,singleSelectedCountEl:Mt,singleListEl:_t,projectsLimitEl:Nt,projectsChatsLimitEl:Ut,projectsStatusEl:Ht,btnProjectsDelete:Gt,projectsExecOutEl:Ft,projectsChatsExecProgressWrapEl:Jt,projectsChatsExecProgressEl:Vt,projectsChatsExecProgressTextEl:Wt,projectsProjectsExecProgressWrapEl:Kt,projectsProjectsExecProgressEl:Xt,projectsProjectsExecProgressTextEl:Yt,projectsConfirmBoxEl:Qt,projectsConfirmTitleEl:qt,projectsConfirmPreviewEl:en,projectsCbConfirmEl:tn,projectsBtnConfirmExecute:nn,projectsBtnCancelExecute:sn,projectsCountEl:cn,projectsChatsCountEl:on,projectsSelectedChatsCountEl:an,projectsSelectedProjectsCountEl:rn,projectsListEl:ln,mountCreateProjectProjectsEl:dn,mountCreateProjectOrganizeEl:un,logsLimitEl:gn,btnLogsRefresh:pn,logsStatusEl:mn,logsTrimKeepEl:hn,btnLogsTrim:fn,btnLogsExport:Tn,btnLogsClear:En,logsOutEl:Cn,cfgShowDevToolsEl:Sn,settingsGeneralStatusEl:bn,apiOriginEl:vn,btnApiOriginReset:yn,apiOriginStatusEl:jn,settingsVersionEl:In,settingsGitHubLinkEl:Pn,devConfigDetailsEl:xn,settingsConnectionBoxEl:Ln,cfgTraceScopeEl:wn,cfgStopAfterOutOfScopeEl:zn,btnCfgResetDefaults:kn,cfgStatusEl:On,cfgActionLogMaxEl:Dn,cfgDebugTraceMaxEl:Zn,cfgFailureLogsPerRunEl:Bn,logsCbDebugEl:An,debugLimitEl:$n,btnDebugRefresh:Rn,btnDebugExport:Mn,btnDebugClear:_n,debugStatusEl:Nn,debugOutEl:Un,btnStatsRecalc:Hn,statsStatusEl:Gn,statsLastCacheUpdateEl:Fn,statsSnapshotBoxEl:Jn,statsSingleChatsEl:Vn,statsProjectsEl:Wn,statsProjectChatsEl:Kn,statsTotalChatsEl:Xn,statsArchivedChatsEl:Yn,statsAvgChatsPerProjectEl:Qn,statsLimitsHintEl:qn,statsActivityBoxEl:ei,statsActivityExplainEl:ti,statsCreatedHeatmapEl:ni,statsLifetimeHistEl:ii,statsProjectsBoxEl:si,statsProjectSizeHistEl:ci,statsTopProjectsEl:oi,statsDeletesBoxEl:ai,statsDeletedChatsEl:ri,statsDeletedProjectsEl:li,organizeSourceEl:di,organizeFilterEl:ui,cbOrganizeToggleAll:gi,organizeSourceStatusEl:pi,organizeSourceCountEl:mi,organizeSelectedCountEl:hi,organizeSourceListEl:fi,organizeProjectFilterEl:Ti,btnOrganizeClearTarget:Ei,organizeProjectsStatusEl:Ci,organizeProjectsCountEl:Si,organizeTargetLabelEl:bi,organizeProjectListEl:vi,btnOrganizeMove:yi,organizeExecOutEl:ji,organizeExecProgressWrapEl:Ii,organizeExecProgressEl:Pi,organizeExecProgressTextEl:xi,organizeConfirmBoxEl:Li,organizeConfirmTitleEl:wi,organizeConfirmPreviewEl:zi,organizeCbConfirmEl:ki,organizeBtnConfirmExecute:Oi,organizeBtnCancelExecute:Di}}const B={PING:"CGO_PING",PANEL_REFRESH_ALL:"CGO_PANEL_REFRESH_ALL",LIST_ALL_CHATS:"CGO_LIST_ALL_CHATS",LIST_ALL_CHATS_PROGRESS:"CGO_LIST_ALL_CHATS_PROGRESS",LIST_ALL_CHATS_DONE:"CGO_LIST_ALL_CHATS_DONE",LIST_GIZMO_PROJECTS:"CGO_LIST_GIZMO_PROJECTS",LIST_GIZMO_PROJECTS_PROGRESS:"CGO_LIST_GIZMO_PROJECTS_PROGRESS",LIST_GIZMO_PROJECTS_DONE:"CGO_LIST_GIZMO_PROJECTS_DONE",EXECUTE_DELETE:"CGO_EXECUTE_DELETE",EXECUTE_DELETE_PROGRESS:"CGO_EXECUTE_DELETE_PROGRESS",EXECUTE_DELETE_DONE:"CGO_EXECUTE_DELETE_DONE",DELETE_PROJECTS:"CGO_DELETE_PROJECTS",DELETE_PROJECTS_PROGRESS:"CGO_DELETE_PROJECTS_PROGRESS",DELETE_PROJECTS_DONE:"CGO_DELETE_PROJECTS_DONE",MOVE_CHATS_TO_PROJECT:"CGO_MOVE_CHATS_TO_PROJECT",MOVE_CHATS_TO_PROJECT_PROGRESS:"CGO_MOVE_CHATS_TO_PROJECT_PROGRESS",MOVE_CHATS_TO_PROJECT_DONE:"CGO_MOVE_CHATS_TO_PROJECT_DONE",CREATE_PROJECT:"CGO_CREATE_PROJECT",CREATE_PROJECT_PROGRESS:"CGO_CREATE_PROJECT_PROGRESS",CREATE_PROJECT_DONE:"CGO_CREATE_PROJECT_DONE"},Ie={projects:[{gizmoId:"g-wp",title:"WordPress Plugin Lab",href:"#",conversations:[{id:"c-wp-01",title:"Gutenberg block structure: block.json and edit/save",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-01",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-04T13:00:00Z",pinnedTime:null},{id:"c-wp-02",title:"Theme.json tokens: using WP preset colors properly",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-02",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-05T14:00:00Z",pinnedTime:null},{id:"c-wp-03",title:"Shortcodes vs blocks: when to use what",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-03",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-06T15:00:00Z",pinnedTime:null},{id:"c-wp-04",title:"WP REST API auth: nonce + cookies vs app passwords",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-04",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-07T16:00:00Z",pinnedTime:null},{id:"c-wp-05",title:"Plugin build pipeline: webpack vs Vite for blocks",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-05",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-08T17:00:00Z",pinnedTime:null},{id:"c-wp-06",title:"Internationalization: __(), _x(), and build steps",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-06",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-09T18:00:00Z",pinnedTime:null},{id:"c-wp-07",title:"Security checklist: sanitize, escape, capability checks",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-07",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-10T19:00:00Z",pinnedTime:null},{id:"c-wp-08",title:"FSE templates: managing patterns and template parts",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-08",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-11T20:00:00Z",pinnedTime:null},{id:"c-wp-09",title:"WP-CLI automation: exports, imports, and resets",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-09",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-12T21:00:00Z",pinnedTime:null},{id:"c-wp-10",title:"Performance: object cache, transients, and query reduction",gizmoId:"g-wp",href:"https://chatgpt.com/c/c-wp-10",createTime:"2025-11-03T12:00:00Z",updateTime:"2025-11-13T22:00:00Z",pinnedTime:null}]},{gizmoId:"g-gh",title:"GitHub Workflow & Releases",href:"#",conversations:[{id:"c-gh-01",title:"Release assets: tagging strategy and upload via gh cli",gizmoId:"g-gh",href:"https://chatgpt.com/c/c-gh-01",createTime:"2025-12-01T12:00:00Z",updateTime:"2025-12-02T13:00:00Z",pinnedTime:null},{id:"c-gh-02",title:"Changelog discipline: keep a version.md readable",gizmoId:"g-gh",href:"https://chatgpt.com/c/c-gh-02",createTime:"2025-12-01T12:00:00Z",updateTime:"2025-12-03T14:00:00Z",pinnedTime:null},{id:"c-gh-03",title:"Repo hygiene: .gitignore, large files, and build artifacts",gizmoId:"g-gh",href:"https://chatgpt.com/c/c-gh-03",createTime:"2025-12-01T12:00:00Z",updateTime:"2025-12-04T15:00:00Z",pinnedTime:null},{id:"c-gh-04",title:"Git add: '.' vs '-A' and deletion behavior",gizmoId:"g-gh",href:"https://chatgpt.com/c/c-gh-04",createTime:"2025-12-01T12:00:00Z",updateTime:"2025-12-05T16:00:00Z",pinnedTime:null},{id:"c-gh-05",title:"PR workflow: branch naming and small reviewable commits",gizmoId:"g-gh",href:"https://chatgpt.com/c/c-gh-05",createTime:"2025-12-01T12:00:00Z",updateTime:"2025-12-06T17:00:00Z",pinnedTime:null},{id:"c-gh-06",title:"CI basics: lint, typecheck, build, and release gates",gizmoId:"g-gh",href:"https://chatgpt.com/c/c-gh-06",createTime:"2025-12-01T12:00:00Z",updateTime:"2025-12-07T18:00:00Z",pinnedTime:null}]},{gizmoId:"g-chrome-ext",title:"Chrome Extension Engineering",href:"#",conversations:[{id:"c-chx-01",title:"Manifest V3 overview: service worker + permissions",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-01",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-15T13:00:00Z",pinnedTime:null},{id:"c-chx-02",title:"Messaging patterns: panel ↔ background ↔ content",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-02",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-16T14:00:00Z",pinnedTime:null},{id:"c-chx-03",title:"Storage: chrome.storage.local vs session",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-03",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-17T15:00:00Z",pinnedTime:null},{id:"c-chx-04",title:"Rate limiting: throttling delete operations safely",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-04",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-18T16:00:00Z",pinnedTime:null},{id:"c-chx-05",title:"UI: side panel architecture and tab routing",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-05",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-19T17:00:00Z",pinnedTime:null},{id:"c-chx-06",title:"Testing: creating a demo mode with mocked seams",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-06",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-20T18:00:00Z",pinnedTime:null},{id:"c-chx-07",title:"Error handling: retry policies and progress events",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-07",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-21T19:00:00Z",pinnedTime:null},{id:"c-chx-08",title:"Packaging: dist layout and release zip scripts",gizmoId:"g-chrome-ext",href:"https://chatgpt.com/c/c-chx-08",createTime:"2025-07-14T12:00:00Z",updateTime:"2025-07-22T20:00:00Z",pinnedTime:null}]},{gizmoId:"g-firefox-ext",title:"Firefox Extension Port (WebExtensions)",href:"#",conversations:[{id:"c-ffx-01",title:"Chrome vs Firefox APIs: browser.* polyfills and gaps",gizmoId:"g-firefox-ext",href:"https://chatgpt.com/c/c-ffx-01",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-22T13:00:00Z",pinnedTime:null},{id:"c-ffx-02",title:"MV3 support status: what to avoid for portability",gizmoId:"g-firefox-ext",href:"https://chatgpt.com/c/c-ffx-02",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-23T14:00:00Z",pinnedTime:null},{id:"c-ffx-03",title:"Side panel alternatives: UI constraints in Firefox",gizmoId:"g-firefox-ext",href:"https://chatgpt.com/c/c-ffx-03",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-24T15:00:00Z",pinnedTime:null},{id:"c-ffx-04",title:"Packaging & signing: AMO upload checklist",gizmoId:"g-firefox-ext",href:"https://chatgpt.com/c/c-ffx-04",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-25T16:00:00Z",pinnedTime:null}]},{gizmoId:"g-vite",title:"Vite Build System",href:"#",conversations:[{id:"c-vite-01",title:"Vite plugins: resolveId hooks and swapping seams",gizmoId:"g-vite",href:"https://chatgpt.com/c/c-vite-01",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-02T13:00:00Z",pinnedTime:null},{id:"c-vite-02",title:"Static asset emission: generateBundle and fileName paths",gizmoId:"g-vite",href:"https://chatgpt.com/c/c-vite-02",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-03T14:00:00Z",pinnedTime:null},{id:"c-vite-03",title:"Dev vs build parity: ensuring preview matches prod",gizmoId:"g-vite",href:"https://chatgpt.com/c/c-vite-03",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-04T15:00:00Z",pinnedTime:null},{id:"c-vite-04",title:"Aliasing strategies: regex alias vs plugin-based swapping",gizmoId:"g-vite",href:"https://chatgpt.com/c/c-vite-04",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-05T16:00:00Z",pinnedTime:null},{id:"c-vite-05",title:"TypeScript imports: allowImportingTsExtensions pitfalls",gizmoId:"g-vite",href:"https://chatgpt.com/c/c-vite-05",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-06T17:00:00Z",pinnedTime:null}]},{gizmoId:"g-node",title:"Node.js Backend Patterns",href:"#",conversations:[{id:"c-node-01",title:"HTTP server basics: Express vs Fastify tradeoffs",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-01",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-23T13:00:00Z",pinnedTime:null},{id:"c-node-02",title:"Logging: structured logs and request correlation IDs",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-02",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-24T14:00:00Z",pinnedTime:null},{id:"c-node-03",title:"Auth: session cookies vs JWT in practice",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-03",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-25T15:00:00Z",pinnedTime:null},{id:"c-node-04",title:"Error boundaries: central error middleware strategy",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-04",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-26T16:00:00Z",pinnedTime:null},{id:"c-node-05",title:"Rate limiting: burst control and backoff policies",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-05",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-27T17:00:00Z",pinnedTime:null},{id:"c-node-06",title:"Deployment: process managers and health endpoints",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-06",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-28T18:00:00Z",pinnedTime:null},{id:"c-node-07",title:"Security headers: CSP, HSTS, and X-Frame-Options",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-07",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-29T19:00:00Z",pinnedTime:null},{id:"c-node-08",title:"Postgres patterns: migrations, pool sizing, retries",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-08",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-30T20:00:00Z",pinnedTime:null},{id:"c-node-09",title:"Queues: background jobs and idempotency keys",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-09",createTime:"2025-12-22T12:00:00Z",updateTime:"2025-12-31T21:00:00Z",pinnedTime:null},{id:"c-node-10",title:"Monorepo setup: shared types and build pipelines",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-10",createTime:"2025-12-22T12:00:00Z",updateTime:"2026-01-01T22:00:00Z",pinnedTime:null},{id:"c-node-11",title:"Observability: metrics, tracing, dashboards",gizmoId:"g-node",href:"https://chatgpt.com/c/c-node-11",createTime:"2025-12-22T12:00:00Z",updateTime:"2026-01-02T23:00:00Z",pinnedTime:null}]},{gizmoId:"g-ts",title:"TypeScript Deep Dive",href:"#",conversations:[{id:"c-ts-01",title:"Discriminated unions for message buses",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-01",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-14T13:00:00Z",pinnedTime:null},{id:"c-ts-02",title:"Narrowing: type guards and exhaustive checks",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-02",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-15T14:00:00Z",pinnedTime:null},{id:"c-ts-03",title:"Strict mode: fixing implicit any and unknown",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-03",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-16T15:00:00Z",pinnedTime:null},{id:"c-ts-04",title:"API typing: request/response alignment and reuse",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-04",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-17T16:00:00Z",pinnedTime:null},{id:"c-ts-05",title:"Build targets: ESM, CJS, and browser bundles",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-05",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-18T17:00:00Z",pinnedTime:null},{id:"c-ts-06",title:"Module resolution: paths, aliases, and tooling",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-06",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-19T18:00:00Z",pinnedTime:null},{id:"c-ts-07",title:"Runtime validation: zod vs manual checks",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-07",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-20T19:00:00Z",pinnedTime:null},{id:"c-ts-08",title:"Error types: designing safe error objects",gizmoId:"g-ts",href:"https://chatgpt.com/c/c-ts-08",createTime:"2025-10-13T12:00:00Z",updateTime:"2025-10-21T20:00:00Z",pinnedTime:null}]},{gizmoId:"g-ai",title:"AI Engineering Notes",href:"#",conversations:[{id:"c-ai-01",title:"Prompt design: constraints, examples, and failure modes",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-01",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-17T13:00:00Z",pinnedTime:null},{id:"c-ai-02",title:"RAG pipeline: chunking and retrieval tuning",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-02",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-18T14:00:00Z",pinnedTime:null},{id:"c-ai-03",title:"Evaluation: golden sets and regression tests",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-03",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-19T15:00:00Z",pinnedTime:null},{id:"c-ai-04",title:"Safety: what to log vs what not to log",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-04",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-20T16:00:00Z",pinnedTime:null},{id:"c-ai-05",title:"Latency: caching, streaming, and batching strategies",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-05",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-21T17:00:00Z",pinnedTime:null},{id:"c-ai-06",title:"Cost control: token budgets and request shaping",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-06",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-22T18:00:00Z",pinnedTime:null},{id:"c-ai-07",title:"Agent orchestration: tools, retries, and guardrails",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-07",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-23T19:00:00Z",pinnedTime:null},{id:"c-ai-08",title:"Model selection: quality vs speed tradeoffs",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-08",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-24T20:00:00Z",pinnedTime:null},{id:"c-ai-09",title:"Data privacy: redaction strategies and minimization",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-09",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-25T21:00:00Z",pinnedTime:null},{id:"c-ai-10",title:"Vector DB options: what matters in production",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-10",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-26T22:00:00Z",pinnedTime:null},{id:"c-ai-11",title:"Embedding drift: how to re-index safely",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-11",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-27T23:00:00Z",pinnedTime:null},{id:"c-ai-12",title:"Fine-tuning vs prompting: decision checklist",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-12",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-29T00:00:00Z",pinnedTime:null},{id:"c-ai-13",title:"Multi-language: tokenization surprises and UX",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-13",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-30T01:00:00Z",pinnedTime:null},{id:"c-ai-14",title:"Human-in-the-loop: review workflows that scale",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-14",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-07-01T02:00:00Z",pinnedTime:null},{id:"c-ai-15",title:"Incident playbook: model outages and fallback plans",gizmoId:"g-ai",href:"https://chatgpt.com/c/c-ai-15",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-07-02T03:00:00Z",pinnedTime:null}]},{gizmoId:"g-algo",title:"Algorithms & Data Structures",href:"#",conversations:[{id:"c-algo-01",title:"Big-O in real life: when it actually matters",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-01",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-09T13:00:00Z",pinnedTime:null},{id:"c-algo-02",title:"Graphs: BFS/DFS patterns and common mistakes",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-02",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-10T14:00:00Z",pinnedTime:null},{id:"c-algo-03",title:"Sorting: stable vs unstable and why you care",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-03",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-11T15:00:00Z",pinnedTime:null},{id:"c-algo-04",title:"Hashing: collisions, load factors, and performance",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-04",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-12T16:00:00Z",pinnedTime:null},{id:"c-algo-05",title:"Dynamic programming: memoization strategy guide",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-05",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-13T17:00:00Z",pinnedTime:null},{id:"c-algo-06",title:"Heaps: priority queues for scheduling tasks",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-06",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-14T18:00:00Z",pinnedTime:null},{id:"c-algo-07",title:"Bit tricks: fast masks and feature flags",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-07",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-15T19:00:00Z",pinnedTime:null},{id:"c-algo-08",title:"Strings: prefix functions, tries, and search",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-08",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-16T20:00:00Z",pinnedTime:null},{id:"c-algo-09",title:"Caching: LRU designs and edge cases",gizmoId:"g-algo",href:"https://chatgpt.com/c/c-algo-09",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-17T21:00:00Z",pinnedTime:null}]},{gizmoId:"g-sec",title:"Security & Hardening",href:"#",conversations:[{id:"c-sec-01",title:"CSP practical guide: reducing XSS risk",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-01",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-24T13:00:00Z",pinnedTime:null},{id:"c-sec-02",title:"CSRF: why it still bites modern apps",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-02",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-25T14:00:00Z",pinnedTime:null},{id:"c-sec-03",title:"Secrets management: env files vs vault",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-03",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-26T15:00:00Z",pinnedTime:null},{id:"c-sec-04",title:"Supply chain: npm audit realities and mitigation",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-04",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-27T16:00:00Z",pinnedTime:null},{id:"c-sec-05",title:"AuthZ: roles, scopes, and permission boundaries",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-05",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-28T17:00:00Z",pinnedTime:null},{id:"c-sec-06",title:"OWASP Top 10: the parts that actually show up",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-06",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-29T18:00:00Z",pinnedTime:null},{id:"c-sec-07",title:"Rate limiting & abuse: bots and scraping controls",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-07",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-06-30T19:00:00Z",pinnedTime:null},{id:"c-sec-08",title:"Server headers: hardening for modern browsers",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-08",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-07-01T20:00:00Z",pinnedTime:null},{id:"c-sec-09",title:"Cookie flags: SameSite, Secure, HttpOnly usage",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-09",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-07-02T21:00:00Z",pinnedTime:null},{id:"c-sec-10",title:"Dependency pinning: lockfiles and reproducibility",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-10",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-07-03T22:00:00Z",pinnedTime:null},{id:"c-sec-11",title:"TLS basics: certificates, renewals, and traps",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-11",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-07-04T23:00:00Z",pinnedTime:null},{id:"c-sec-12",title:"App isolation: containers and least privilege",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-12",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-07-06T00:00:00Z",pinnedTime:null},{id:"c-sec-13",title:"Logging sensitive data: redaction rules",gizmoId:"g-sec",href:"https://chatgpt.com/c/c-sec-13",createTime:"2025-06-23T12:00:00Z",updateTime:"2025-07-07T01:00:00Z",pinnedTime:null}]},{gizmoId:"g-license",title:"Licenses & Compliance",href:"#",conversations:[{id:"c-lic-01",title:"MIT vs Apache-2.0: practical differences",gizmoId:"g-license",href:"https://chatgpt.com/c/c-lic-01",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-17T13:00:00Z",pinnedTime:null},{id:"c-lic-02",title:"GPL concerns: linking, distribution, and obligations",gizmoId:"g-license",href:"https://chatgpt.com/c/c-lic-02",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-18T14:00:00Z",pinnedTime:null},{id:"c-lic-03",title:"Third-party notices: what to ship with releases",gizmoId:"g-license",href:"https://chatgpt.com/c/c-lic-03",createTime:"2025-06-16T12:00:00Z",updateTime:"2025-06-19T15:00:00Z",pinnedTime:null}]},{gizmoId:"g-cpp",title:"C++ Foundations",href:"#",conversations:[{id:"c-cpp-01",title:"Modern C++: RAII, smart pointers, and ownership",gizmoId:"g-cpp",href:"https://chatgpt.com/c/c-cpp-01",createTime:"2025-09-08T12:00:00Z",updateTime:"2025-09-09T13:00:00Z",pinnedTime:null},{id:"c-cpp-02",title:"Build systems: CMake patterns that don’t hurt",gizmoId:"g-cpp",href:"https://chatgpt.com/c/c-cpp-02",createTime:"2025-09-08T12:00:00Z",updateTime:"2025-09-10T14:00:00Z",pinnedTime:null},{id:"c-cpp-03",title:"Undefined behavior: why it is worse than bugs",gizmoId:"g-cpp",href:"https://chatgpt.com/c/c-cpp-03",createTime:"2025-09-08T12:00:00Z",updateTime:"2025-09-11T15:00:00Z",pinnedTime:null},{id:"c-cpp-04",title:"Move semantics: when it actually helps",gizmoId:"g-cpp",href:"https://chatgpt.com/c/c-cpp-04",createTime:"2025-09-08T12:00:00Z",updateTime:"2025-09-12T16:00:00Z",pinnedTime:null},{id:"c-cpp-05",title:"Templates: compile-time errors and diagnostics",gizmoId:"g-cpp",href:"https://chatgpt.com/c/c-cpp-05",createTime:"2025-09-08T12:00:00Z",updateTime:"2025-09-13T17:00:00Z",pinnedTime:null}]},{gizmoId:"g-python",title:"Python Tooling",href:"#",conversations:[{id:"c-py-01",title:"Virtualenv vs Poetry vs uv: picking one",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-01",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-19T13:00:00Z",pinnedTime:null},{id:"c-py-02",title:"Type hints: mypy/pyright strategy",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-02",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-20T14:00:00Z",pinnedTime:null},{id:"c-py-03",title:"FastAPI patterns: dependencies and testing",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-03",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-21T15:00:00Z",pinnedTime:null},{id:"c-py-04",title:"Packaging: wheels, sdists, and versioning",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-04",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-22T16:00:00Z",pinnedTime:null},{id:"c-py-05",title:"Scripting: CLI ergonomics and config layout",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-05",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-23T17:00:00Z",pinnedTime:null},{id:"c-py-06",title:"Data processing: pandas performance basics",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-06",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-24T18:00:00Z",pinnedTime:null},{id:"c-py-07",title:"Async: when to use asyncio and when not",gizmoId:"g-python",href:"https://chatgpt.com/c/c-py-07",createTime:"2025-08-18T12:00:00Z",updateTime:"2025-08-25T19:00:00Z",pinnedTime:null}]},{gizmoId:"g-docker",title:"Docker & Compose",href:"#",conversations:[{id:"c-dk-01",title:"Compose profiles: clean dev vs prod separation",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-01",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-11T13:00:00Z",pinnedTime:null},{id:"c-dk-02",title:"Healthchecks: making dependencies reliable",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-02",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-12T14:00:00Z",pinnedTime:null},{id:"c-dk-03",title:"Volumes: avoiding permission hell with UID/GID",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-03",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-13T15:00:00Z",pinnedTime:null},{id:"c-dk-04",title:"Build stages: small images and fast rebuilds",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-04",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-14T16:00:00Z",pinnedTime:null},{id:"c-dk-05",title:"Reverse proxy patterns: Apache vs Nginx",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-05",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-15T17:00:00Z",pinnedTime:null},{id:"c-dk-06",title:"Static hosting container: serving dist/ safely",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-06",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-16T18:00:00Z",pinnedTime:null},{id:"c-dk-07",title:"Secrets: env files vs Docker secrets",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-07",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-17T19:00:00Z",pinnedTime:null},{id:"c-dk-08",title:"Network: internal URLs and cross-service calls",gizmoId:"g-docker",href:"https://chatgpt.com/c/c-dk-08",createTime:"2025-11-10T12:00:00Z",updateTime:"2025-11-18T20:00:00Z",pinnedTime:null}]},{gizmoId:"g-next",title:"Next.js Notes",href:"#",conversations:[{id:"c-next-01",title:"App Router: layouts, pages, and route handlers",gizmoId:"g-next",href:"https://chatgpt.com/c/c-next-01",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-02T13:00:00Z",pinnedTime:null},{id:"c-next-02",title:"Deployment: build output and runtime configs",gizmoId:"g-next",href:"https://chatgpt.com/c/c-next-02",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-03T14:00:00Z",pinnedTime:null},{id:"c-next-03",title:"Static assets: serving under a subpath cleanly",gizmoId:"g-next",href:"https://chatgpt.com/c/c-next-03",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-04T15:00:00Z",pinnedTime:null},{id:"c-next-04",title:"Auth flow: proxy headers and cookie security",gizmoId:"g-next",href:"https://chatgpt.com/c/c-next-04",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-05T16:00:00Z",pinnedTime:null},{id:"c-next-05",title:"Performance: bundle analysis and caching",gizmoId:"g-next",href:"https://chatgpt.com/c/c-next-05",createTime:"2025-09-01T12:00:00Z",updateTime:"2025-09-06T17:00:00Z",pinnedTime:null}]},{gizmoId:"g-rest",title:"REST API Design",href:"#",conversations:[{id:"c-rest-01",title:"Pagination: cursor vs offset",gizmoId:"g-rest",href:"https://chatgpt.com/c/c-rest-01",createTime:"2025-11-17T12:00:00Z",updateTime:"2025-11-18T13:00:00Z",pinnedTime:null},{id:"c-rest-02",title:"Error formats: consistent error contracts",gizmoId:"g-rest",href:"https://chatgpt.com/c/c-rest-02",createTime:"2025-11-17T12:00:00Z",updateTime:"2025-11-19T14:00:00Z",pinnedTime:null}]},{gizmoId:"g-uiux",title:"UI/UX for Developer Tools",href:"#",conversations:[{id:"c-ui-01",title:"Progress UI: what users need to trust it",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-01",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-12T13:00:00Z",pinnedTime:null},{id:"c-ui-02",title:"Confirmation dialogs: reducing destructive mistakes",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-02",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-13T14:00:00Z",pinnedTime:null},{id:"c-ui-03",title:"Information density: logs that stay readable",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-03",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-14T15:00:00Z",pinnedTime:null},{id:"c-ui-04",title:"Keyboard navigation: focus order and ARIA basics",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-04",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-15T16:00:00Z",pinnedTime:null},{id:"c-ui-05",title:"UX copy: writing status messages that aren’t lies",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-05",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-16T17:00:00Z",pinnedTime:null},{id:"c-ui-06",title:"Empty states: making the UI feel alive",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-06",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-17T18:00:00Z",pinnedTime:null},{id:"c-ui-07",title:"Filter/search: fast client-side techniques",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-07",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-18T19:00:00Z",pinnedTime:null},{id:"c-ui-08",title:"Design tokens: theme-aware colors and spacing",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-08",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-19T20:00:00Z",pinnedTime:null},{id:"c-ui-09",title:"Accessibility: contrast and reduced motion",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-09",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-20T21:00:00Z",pinnedTime:null},{id:"c-ui-10",title:"Responsive layout: two-column split strategies",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-10",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-21T22:00:00Z",pinnedTime:null},{id:"c-ui-11",title:"Error feedback: inline vs toast vs log-only",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-11",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-22T23:00:00Z",pinnedTime:null},{id:"c-ui-12",title:"Consistency: reusable components in the panel",gizmoId:"g-uiux",href:"https://chatgpt.com/c/c-ui-12",createTime:"2025-08-11T12:00:00Z",updateTime:"2025-08-24T00:00:00Z",pinnedTime:null}]},{gizmoId:"g-testing",title:"Testing & QA",href:"#",conversations:[{id:"c-tst-01",title:"Smoke tests: verifying build artifacts exist",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-01",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-22T13:00:00Z",pinnedTime:null},{id:"c-tst-02",title:"Type-check gates: catching message schema drift",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-02",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-23T14:00:00Z",pinnedTime:null},{id:"c-tst-03",title:"Mocking seams: runtime + storage wrappers",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-03",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-24T15:00:00Z",pinnedTime:null},{id:"c-tst-04",title:"Regression tests: keep demo data stable for screenshots",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-04",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-25T16:00:00Z",pinnedTime:null},{id:"c-tst-05",title:"E2E: controlling flakiness with deterministic fixtures",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-05",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-26T17:00:00Z",pinnedTime:null},{id:"c-tst-06",title:"Error injection: simulate failures and retries",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-06",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-27T18:00:00Z",pinnedTime:null},{id:"c-tst-07",title:"Performance: measuring UI responsiveness",gizmoId:"g-testing",href:"https://chatgpt.com/c/c-tst-07",createTime:"2025-07-21T12:00:00Z",updateTime:"2025-07-28T19:00:00Z",pinnedTime:null}]},{gizmoId:"g-arch",title:"Architecture & Refactors",href:"#",conversations:[{id:"c-arch-01",title:"Separating platform seams: runtime, storage, fetch",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-01",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-09T13:00:00Z",pinnedTime:null},{id:"c-arch-02",title:"Cache strategy: snapshots and subscriptions",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-02",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-10T14:00:00Z",pinnedTime:null},{id:"c-arch-03",title:"Events vs responses: progress events contract",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-03",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-11T15:00:00Z",pinnedTime:null},{id:"c-arch-04",title:"Logging tiers: audit log vs debug trace",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-04",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-12T16:00:00Z",pinnedTime:null},{id:"c-arch-05",title:"Config handling: dev config vs API config",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-05",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-13T17:00:00Z",pinnedTime:null},{id:"c-arch-06",title:"Keeping code clean: no backward compatibility hacks",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-06",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-14T18:00:00Z",pinnedTime:null},{id:"c-arch-07",title:"Message typing: union composition in shared/messages",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-07",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-15T19:00:00Z",pinnedTime:null},{id:"c-arch-08",title:"Organize tab: confirm UI layout improvements",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-08",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-16T20:00:00Z",pinnedTime:null},{id:"c-arch-09",title:"Scope system: YMD filtering and out-of-scope guard",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-09",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-17T21:00:00Z",pinnedTime:null},{id:"c-arch-10",title:"Release tooling: zip builds and GitHub automation",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-10",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-18T22:00:00Z",pinnedTime:null},{id:"c-arch-11",title:"Demo packaging: dist independence and embedding",gizmoId:"g-arch",href:"https://chatgpt.com/c/c-arch-11",createTime:"2025-12-08T12:00:00Z",updateTime:"2025-12-19T23:00:00Z",pinnedTime:null}]},{gizmoId:"g-misc",title:"Misc Notes & Scratchpad",href:"#",conversations:[{id:"c-misc-01",title:"Naming: choosing clear message constants",gizmoId:"g-misc",href:"https://chatgpt.com/c/c-misc-01",createTime:"2025-07-07T12:00:00Z",updateTime:"2025-07-08T13:00:00Z",pinnedTime:null},{id:"c-misc-02",title:"UI polish: microcopy and empty state wording",gizmoId:"g-misc",href:"https://chatgpt.com/c/c-misc-02",createTime:"2025-07-07T12:00:00Z",updateTime:"2025-07-09T14:00:00Z",pinnedTime:null}]}],singles:[{id:"c-s-01",title:"Quickstart: build and load unpacked extension",gizmoId:null,href:"https://chatgpt.com/c/c-s-01",createTime:"2026-01-08T12:00:00Z",updateTime:"2026-01-08T13:00:00Z",pinnedTime:null},{id:"c-s-02",title:"Debugging: why a tab click does nothing",gizmoId:null,href:"https://chatgpt.com/c/c-s-02",createTime:"2026-01-04T12:00:00Z",updateTime:"2026-01-04T14:00:00Z",pinnedTime:null},{id:"c-s-03",title:"Vite: dev vs preview and why it matters",gizmoId:null,href:"https://chatgpt.com/c/c-s-03",createTime:"2025-12-31T12:00:00Z",updateTime:"2025-12-31T15:00:00Z",pinnedTime:null},{id:"c-s-04",title:"TypeScript error: union event types mismatch",gizmoId:null,href:"https://chatgpt.com/c/c-s-04",createTime:"2025-12-27T12:00:00Z",updateTime:"2025-12-27T16:00:00Z",pinnedTime:null},{id:"c-s-05",title:"Chrome storage: local vs sync differences",gizmoId:null,href:"https://chatgpt.com/c/c-s-05",createTime:"2025-12-23T12:00:00Z",updateTime:"2025-12-23T17:00:00Z",pinnedTime:null},{id:"c-s-06",title:"Design: two-column layout for safer confirmations",gizmoId:null,href:"https://chatgpt.com/c/c-s-06",createTime:"2025-12-19T12:00:00Z",updateTime:"2025-12-19T18:00:00Z",pinnedTime:null},{id:"c-s-07",title:"Security: CSP and embedding via iframe",gizmoId:null,href:"https://chatgpt.com/c/c-s-07",createTime:"2025-12-15T12:00:00Z",updateTime:"2025-12-15T19:00:00Z",pinnedTime:null},{id:"c-s-08",title:"Git: stash vs commit for interrupted scripts",gizmoId:null,href:"https://chatgpt.com/c/c-s-08",createTime:"2025-12-11T12:00:00Z",updateTime:"2025-12-11T20:00:00Z",pinnedTime:null},{id:"c-s-09",title:"Release automation: tag + upload assets",gizmoId:null,href:"https://chatgpt.com/c/c-s-09",createTime:"2025-12-07T12:00:00Z",updateTime:"2025-12-07T21:00:00Z",pinnedTime:null},{id:"c-s-10",title:"Node audit: handling moderate vulnerabilities",gizmoId:null,href:"https://chatgpt.com/c/c-s-10",createTime:"2025-12-03T12:00:00Z",updateTime:"2025-12-03T22:00:00Z",pinnedTime:null},{id:"c-s-11",title:"Next.js proxy: Apache headers and websocket upgrade",gizmoId:null,href:"https://chatgpt.com/c/c-s-11",createTime:"2025-11-29T12:00:00Z",updateTime:"2025-11-29T23:00:00Z",pinnedTime:null},{id:"c-s-12",title:"Mocking: seam swap for runtime and storage",gizmoId:null,href:"https://chatgpt.com/c/c-s-12",createTime:"2025-11-25T12:00:00Z",updateTime:"2025-11-26T00:00:00Z",pinnedTime:null},{id:"c-s-13",title:"API design: progress events contract",gizmoId:null,href:"https://chatgpt.com/c/c-s-13",createTime:"2025-11-21T12:00:00Z",updateTime:"2025-11-22T01:00:00Z",pinnedTime:null},{id:"c-s-14",title:"UI: logs tab export and trimming strategy",gizmoId:null,href:"https://chatgpt.com/c/c-s-14",createTime:"2025-11-17T12:00:00Z",updateTime:"2025-11-18T02:00:00Z",pinnedTime:null},{id:"c-s-15",title:"Organize: moving chats to projects workflow",gizmoId:null,href:"https://chatgpt.com/c/c-s-15",createTime:"2025-11-13T12:00:00Z",updateTime:"2025-11-14T03:00:00Z",pinnedTime:null},{id:"c-s-16",title:"Performance: caching and update throttling",gizmoId:null,href:"https://chatgpt.com/c/c-s-16",createTime:"2025-11-09T12:00:00Z",updateTime:"2025-11-10T04:00:00Z",pinnedTime:null},{id:"c-s-17",title:"License: choosing MIT vs Apache for a tool",gizmoId:null,href:"https://chatgpt.com/c/c-s-17",createTime:"2025-11-05T12:00:00Z",updateTime:"2025-11-06T05:00:00Z",pinnedTime:null},{id:"c-s-18",title:"CSS: why panel looks ugly in demo build",gizmoId:null,href:"https://chatgpt.com/c/c-s-18",createTime:"2025-11-01T12:00:00Z",updateTime:"2025-11-02T06:00:00Z",pinnedTime:null},{id:"c-s-19",title:"Troubleshooting: missing DOM id errors in panel",gizmoId:null,href:"https://chatgpt.com/c/c-s-19",createTime:"2025-10-28T12:00:00Z",updateTime:"2025-10-29T07:00:00Z",pinnedTime:null}]};function He(e){return e?Date.parse(`${e}T00:00:00.000Z`):-1/0}function ie(e){const t=(e==null?void 0:e.updateTime)||(e==null?void 0:e.createTime),i=typeof t=="string"?Date.parse(t):NaN;return Number.isFinite(i)?i:0}function ne(){return Date.now()}async function Ai(e){switch(e.type){case B.LIST_GIZMO_PROJECTS:{const t=ne();W({type:B.LIST_GIZMO_PROJECTS_PROGRESS,foundProjects:0,foundConversations:0}),await se(150);const i=e.scopeYmd,n=Number(e.limit??e.limitProjects??50),s=Number(e.perProjectLimit??50),r=He(i),a=Ie.projects.map(P=>{const b=(P.conversations??[]).filter(c=>ie(c)>=r).sort((c,d)=>ie(d)-ie(c)).slice(0,s);return{...P,conversations:b}}).slice(0,n),l=a.length,u=a.reduce((P,b)=>{var c;return P+(((c=b.conversations)==null?void 0:c.length)||0)},0);return W({type:B.LIST_GIZMO_PROJECTS_DONE,totalProjects:l,totalConversations:u,elapsedMs:ne()-t}),{ok:!0,projects:a}}case B.LIST_ALL_CHATS:{const t=ne();W({type:B.LIST_ALL_CHATS_PROGRESS,found:0}),await se(120);const i=e.scopeYmd,n=Number(e.pageSize??50),s=Number(e.limit??n),r=He(i),a=Ie.singles.filter(l=>ie(l)>=r).sort((l,u)=>ie(u)-ie(l)).slice(0,s);return W({type:B.LIST_ALL_CHATS_DONE,total:a.length,elapsedMs:ne()-t}),{ok:!0,conversations:a}}case B.EXECUTE_DELETE:{const t=e.ids,i=`run-${ne()}`;let n=0;for(const s of t)n++,await se(80),W({type:B.EXECUTE_DELETE_PROGRESS,runId:i,i:n,total:t.length,id:s,ok:!0,status:200,attempt:1,elapsedMs:0,lastOpMs:80});return W({type:B.EXECUTE_DELETE_DONE,runId:i,total:t.length,okCount:t.length,failCount:0,elapsedMs:0}),{ok:!0}}case B.MOVE_CHATS_TO_PROJECT:{const t=e.ids,i=`run-${ne()}`;let n=0;for(const s of t)n++,await se(90),W({type:B.MOVE_CHATS_TO_PROJECT_PROGRESS,runId:i,i:n,total:t.length,id:s,ok:!0,status:200,elapsedMs:0,lastOpMs:90});return W({type:B.MOVE_CHATS_TO_PROJECT_DONE,runId:i,total:t.length,okCount:t.length,failCount:0,elapsedMs:0}),{ok:!0}}case B.CREATE_PROJECT:{W({type:B.CREATE_PROJECT_PROGRESS,status:"creating"}),await se(120);const t=`g-${Math.random().toString(16).slice(2,10)}`,n=String(e.name??"").trim()||"Untitled project",s=`https://chatgpt.com/g/${t}`,r=`pc-${Math.random().toString(16).slice(2,10)}`,a={gizmoId:t,title:n,href:s,conversations:[{id:r,title:`Welcome to ${n}`,href:`https://chatgpt.com/c/${r}`,gizmoId:t,updateTime:new Date().toISOString(),createTime:new Date().toISOString()}]};return Ie.projects.unshift(a),W({type:B.CREATE_PROJECT_DONE,ok:!0,gizmoId:t,title:n,href:s}),{ok:!0,gizmoId:t,title:n,href:s}}case B.DELETE_PROJECTS:{const t=e.gizmoIds,i=`run-${ne()}`;let n=0;for(const s of t)n++,await se(100),W({type:B.DELETE_PROJECTS_PROGRESS,runId:i,i:n,total:t.length,gizmoId:s,ok:!0,status:200,elapsedMs:0,lastOpMs:100});return W({type:B.DELETE_PROJECTS_DONE,runId:i,total:t.length,okCount:t.length,failCount:0,elapsedMs:0}),{ok:!0}}default:return{ok:!1,error:`Demo handler not implemented for: ${e==null?void 0:e.type}`}}}function se(e){return new Promise(t=>setTimeout(t,e))}const Ae=new Set;function qe(e){for(const t of Ae)t(e,"local")}function de(e){const t=localStorage.getItem(e);if(t!==null)try{return JSON.parse(t)}catch{return t}}function $i(e,t){localStorage.setItem(e,JSON.stringify(t))}async function ee(e){if(typeof e=="string")return{[e]:de(e)};if(Array.isArray(e)){const i={};for(const n of e)i[n]=de(n);return i}const t={};for(const[i,n]of Object.entries(e))t[i]=localStorage.getItem(i)!==null?de(i):n;return t}async function te(e){const t={};for(const[i,n]of Object.entries(e)){const s=de(i);$i(i,n),t[i]={oldValue:s,newValue:n}}qe(t)}async function $e(e){const t=Array.isArray(e)?e:[e],i={};for(const n of t){const s=de(n);localStorage.removeItem(n),i[n]={oldValue:s,newValue:void 0}}qe(i)}function Ri(e){Ae.add(e),window.addEventListener("storage",t=>{t.key&&e({[t.key]:{oldValue:t.oldValue,newValue:t.newValue}},"local")})}function Mi(e){Ae.delete(e)}function F(e,t,i,n){const s=Number(String(e??"").trim());return Number.isFinite(s)?Math.max(t,Math.min(i,Math.floor(s))):n}function _(e){return Number.isFinite(e)?e<1e3?`${e}ms`:`${Math.round(e/100)/10}s`:"?"}const ze="cgo.devConfig",H={traceScope:!1,stopAfterOutOfScopeProjects:3,actionLogMax:5e3,debugTraceMax:2e3,failureLogsPerRun:50};let ke=!1,Ee={...H};function et(e){const t=e||{};return{traceScope:!!t.traceScope,stopAfterOutOfScopeProjects:F(t.stopAfterOutOfScopeProjects??H.stopAfterOutOfScopeProjects,0,5e3,H.stopAfterOutOfScopeProjects),actionLogMax:F(t.actionLogMax??H.actionLogMax,100,5e4,H.actionLogMax),debugTraceMax:F(t.debugTraceMax??H.debugTraceMax,100,5e4,H.debugTraceMax),failureLogsPerRun:F(t.failureLogsPerRun??H.failureLogsPerRun,0,5e4,H.failureLogsPerRun)}}async function oe(){if(ke)return;const e=await ee([ze]).catch(()=>({}));Ee=et(e==null?void 0:e[ze]),ke=!0}function ae(){return Ee}async function tt(e){Ee=et(e),ke=!0,await te({[ze]:Ee}).catch(()=>null)}async function _i(){await tt({...H})}const ue="cgo.debugTrace",Oe="cgo.debugTrace.enabled",Ni=2e3;function Ui(){return`${Date.now()}-${Math.random().toString(16).slice(2)}`}function De(e,t,i){return Math.max(t,Math.min(i,Math.floor(e)))}async function Re(){const e=await ee(ue),t=e==null?void 0:e[ue];return Array.isArray(t)?t:[]}async function Hi(e){await te({[ue]:e})}async function Me(){const e=await ee(Oe);return!!(e!=null&&e[Oe])}async function nt(e){await te({[Oe]:!!e}),e||await $e(ue)}async function it(){await $e(ue)}async function Z(e,t){if(!await Me())return{total:0};let n=t==null?void 0:t.max;typeof n!="number"&&(await oe(),n=ae().debugTraceMax),n=De(n??Ni,100,5e4);const s=(Array.isArray(e)?e:[e]).map(u=>({...u,id:Ui(),ts:Date.now()})),a=(await Re()).concat(s),l=a.length>n?a.slice(a.length-n):a;return await Hi(l),{total:l.length}}async function st(e){const t=De((e==null?void 0:e.limit)??200,1,5e4),i=De((e==null?void 0:e.offset)??0,0,1e6),n=(e==null?void 0:e.reverse)??!0,s=await Re(),r=s.length,l=(n?s.slice().reverse():s).slice(i,i+t);return{total:r,items:l}}async function ct(e){const t=await Re();return JSON.stringify(t,null,e!=null&&e.pretty?2:0)}const ot=Object.freeze(Object.defineProperty({__proto__:null,append:Z,clear:it,exportJson:ct,isEnabled:Me,list:st,setEnabled:nt},Symbol.toStringTag,{value:"Module"})),at=new Set;function W(e){for(const t of Array.from(at))t(e)}function Gi(e){at.add(e)}async function Q(e){const t=(e==null?void 0:e.type)??"unknown";Z({scope:"demo",kind:"debug",message:"runtimeSend:IN",meta:{type:t,msg:e,stack:String(new Error().stack||"").split(`
`).slice(0,8).join(`
`)}});const i=await Promise.resolve(Ai(e));return Z({scope:"demo",kind:"debug",message:"runtimeSend:OUT",meta:{type:t,res:i}}),i}function Fi(){const e=new Set;function t(n){return e.add(n),()=>e.delete(n)}function i(){Gi(s=>{for(const r of e)r(s)})}return{on:t,start:i}}function Ji(e,t){let i="single";function n(l){const u=P=>l===P;e.tabSingle.classList.toggle("is-active",u("single")),e.tabSingle.setAttribute("aria-selected",String(u("single"))),e.viewSingle.hidden=!u("single"),e.tabProjects.classList.toggle("is-active",u("projects")),e.tabProjects.setAttribute("aria-selected",String(u("projects"))),e.viewProjects.hidden=!u("projects"),e.tabSearch.classList.toggle("is-active",u("search")),e.tabSearch.setAttribute("aria-selected",String(u("search"))),e.viewSearch.hidden=!u("search"),e.tabOrganize.classList.toggle("is-active",u("organize")),e.tabOrganize.setAttribute("aria-selected",String(u("organize"))),e.viewOrganize.hidden=!u("organize"),e.tabSettings.classList.toggle("is-active",u("settings")),e.tabSettings.setAttribute("aria-selected",String(u("settings"))),e.viewSettings.hidden=!u("settings"),e.tabLogs.classList.toggle("is-active",u("logs")),e.tabLogs.setAttribute("aria-selected",String(u("logs"))),e.viewLogs.hidden=!u("logs"),e.tabStats.classList.toggle("is-active",u("stats")),e.tabStats.setAttribute("aria-selected",String(u("stats"))),e.viewStats.hidden=!u("stats")}function s(l){l!==i&&(t[i].unmount(),i=l,n(i),t[i].mount())}function r(){e.tabSingle.addEventListener("click",()=>s("single")),e.tabProjects.addEventListener("click",()=>s("projects")),e.tabOrganize.addEventListener("click",()=>s("organize")),e.tabSearch.addEventListener("click",()=>s("search")),e.tabSettings.addEventListener("click",()=>s("settings")),e.tabLogs.addEventListener("click",()=>s("logs")),e.tabStats.addEventListener("click",()=>s("stats"))}function a(){n(i),t[i].mount()}return{bind:r,boot:a,switchTo:s}}function Vi(e){var i;let t=0;for(const n of e)t+=((i=n.conversations)==null?void 0:i.length)||0;return t}function Ge(e){const t=Vi(e.projects),i=e.singleChats.length,n=e.projects.length;return{singleChats:e.singleChats,projects:e.projects,counts:{singleChats:i,projects:n,projectChats:t,totalChats:i+t},meta:e.meta}}function Wi(){const e={singleChats:[],projects:[],meta:{}},t=new Set;function i(){const o=Ge(e);for(const T of t)try{T(o)}catch{}}function n(o){e.meta.scopeUpdatedSince=o,i()}function s(){return String(e.meta.scopeUpdatedSince||"")}function r(){return Ge(e)}function a(o){t.add(o);try{o(r())}catch{}return()=>t.delete(o)}function l(){e.singleChats=[],e.projects=[],e.meta={},i()}function u(o,T){e.singleChats=o.slice(),e.meta.singleUpdatedTs=Date.now(),typeof(T==null?void 0:T.limit)=="number"&&(e.meta.singleLimit=T.limit),i()}function P(o,T){e.projects=o.slice(),e.meta.projectsUpdatedTs=Date.now(),typeof(T==null?void 0:T.limitProjects)=="number"&&(e.meta.projectsLimit=T.limitProjects),typeof(T==null?void 0:T.chatsPerProject)=="number"&&(e.meta.projectsChatsLimit=T.chatsPerProject),i()}function b(o){var y;const T=e.singleChats.length;e.singleChats=e.singleChats.filter(I=>I.id!==o);let m=!1;const f=[];for(const I of e.projects){const S=((y=I.conversations)==null?void 0:y.length)||0,C=(I.conversations||[]).filter(g=>g.id!==o);C.length!==S&&(m=!0),f.push(S===C.length?I:{...I,conversations:C})}(e.singleChats.length!==T||m)&&(e.projects=f,i())}function c(o){const T=e.projects.length;e.projects=e.projects.filter(m=>m.gizmoId!==o),e.projects.length!==T&&i()}function d(o,T){const f=e.projects.some(y=>y.gizmoId===o.gizmoId)?e.projects:[o,...e.projects];P(f,T??{limitProjects:e.meta.projectsLimit,chatsPerProject:e.meta.projectsChatsLimit})}function p(o){const{ids:T,targetProjectId:m,metaById:f}=o,y=new Set(T),I=e.singleChats.filter(g=>!y.has(g.id)),S=e.projects.map(g=>({...g,conversations:(g.conversations||[]).filter(j=>!y.has(j.id))})),C=S.find(g=>g.gizmoId===m);if(C){const g=new Set((C.conversations||[]).map(z=>z.id)),j=C.conversations||[];for(const z of T){if(g.has(z))continue;const h=f==null?void 0:f.get(z);j.push({id:z,gizmoId:m,title:(h==null?void 0:h.title)||"Untitled",href:(h==null?void 0:h.href)||"#"})}C.conversations=j;const v=e.meta.projectsChatsLimit;typeof v=="number"&&v>0&&(C.conversations=C.conversations.slice(0,v))}P(S,{limitProjects:e.meta.projectsLimit,chatsPerProject:e.meta.projectsChatsLimit}),u(I,{limit:e.meta.singleLimit})}return{getSnapshot:r,subscribe:a,getScopeUpdatedSince:s,clearAll:l,setSingleChats:u,setProjects:P,removeChat:b,removeProject:c,setScopeUpdatedSince:n,insertProject:d,moveChatsToProject:p}}const Ce="cgo.actionLog",Ki=5e3;function Xi(){return`${Date.now()}-${Math.random().toString(16).slice(2)}`}function Yi(e){return Array.isArray(e)?e:[e]}async function ge(){const e=await ee(Ce),t=e==null?void 0:e[Ce];return Array.isArray(t)?t:[]}async function rt(e){await te({[Ce]:e})}function Se(e,t,i){return Math.max(t,Math.min(i,Math.floor(e)))}async function M(e,t){let i=t==null?void 0:t.max;typeof i!="number"&&(await oe(),i=ae().actionLogMax),i=Se(i??Ki,100,5e4);const s=Yi(e).map(u=>({...u,id:Xi(),ts:Date.now()}));if(!s.length)return{total:(await ge()).length};const a=(await ge()).concat(s),l=a.length>i?a.slice(a.length-i):a;return await rt(l),{total:l.length}}async function Qi(e){const t=Se((e==null?void 0:e.limit)??200,1,5e4),i=Se((e==null?void 0:e.offset)??0,0,1e6);let s=await ge();e!=null&&e.kind&&(s=s.filter(l=>l.kind===e.kind)),e!=null&&e.scope&&(s=s.filter(l=>l.scope===e.scope)),typeof(e==null?void 0:e.sinceTs)=="number"&&(s=s.filter(l=>l.ts>=e.sinceTs)),typeof(e==null?void 0:e.untilTs)=="number"&&(s=s.filter(l=>l.ts<=e.untilTs));const r=s.length;s=s.slice().reverse();const a=s.slice(i,i+t);return{total:r,items:a}}async function qi(e){let i=await ge();if(typeof e.beforeTs=="number"&&(i=i.filter(n=>n.ts>=e.beforeTs)),typeof e.keepLast=="number"){const n=Se(e.keepLast,0,5e4);n===0?i=[]:i.length>n&&(i=i.slice(i.length-n))}return await rt(i),{total:i.length}}async function es(){await $e(Ce)}async function ts(e){const t=await ge();return JSON.stringify(t,null,2)}let q=0;function D(){return q>0}async function be(e,t){lt(e);try{return await t()}finally{ns(e)}}function U(e,t){if(t){lt(e);return}q=0,ve(e,!1)}function lt(e){q++,q===1&&ve(e,!0)}function ns(e){if(q<=0){q=0,ve(e,!1);return}q--,q===0&&ve(e,!1)}function ve(e,t){e.scopeLoadingEl.classList.toggle("is-busy",t),e.btnScopeChange.disabled=t,e.btnScopeRefresh.disabled=t,e.scopeDateEl.disabled=t,e.btnScopeCancel.disabled=t,e.btnScopeApply.disabled=t,e.btnListSingle.disabled=t,e.singleLimitEl.disabled=t,e.cbSingleToggleAll.disabled=t,e.btnSingleDelete.disabled=t,e.btnListProjects.disabled=t,e.projectsLimitEl.disabled=t,e.projectsChatsLimitEl.disabled=t,e.btnProjectsDelete.disabled=t,e.btnSearchListSingle.disabled=t,e.btnSearchListProjects.disabled=t,e.btnSearchResetFilters.disabled=t,e.btnSearchClear.disabled=t,e.searchQueryEl.disabled=t,e.organizeSourceEl.disabled=t,e.organizeFilterEl.disabled=t,e.cbOrganizeToggleAll.disabled=t,e.organizeProjectFilterEl.disabled=t,e.btnOrganizeClearTarget.disabled=t,e.btnOrganizeMove.disabled=t,e.organizeCbConfirmEl.disabled=t,e.organizeBtnConfirmExecute.disabled=t,e.organizeBtnCancelExecute.disabled=t}function is(){let e=[];const t=new Set;function i(l){e=l;const u=new Set(e.map(P=>P.id));for(const P of Array.from(t))u.has(P)||t.delete(P)}function n(l,u){u?t.add(l):t.delete(l)}function s(l){if(l)for(const u of e)t.add(u.id);else for(const u of e)t.delete(u.id)}function r(){return e.filter(l=>t.has(l.id)).map(l=>l.id)}function a(l){e=e.filter(u=>u.id!==l),t.delete(l)}return{get chats(){return e},selected:t,setChats:i,toggle:n,toggleAll:s,getSelectedIds:r,removeChat:a}}function ss(e){function t(b){e.singleStatusEl.textContent=b}function i(b){e.singleExecOutEl.textContent=b}function n(b){const c=e.singleExecOutEl.textContent||"";e.singleExecOutEl.textContent=c?`${c}
${b}`:b,e.singleExecOutEl.scrollTop=e.singleExecOutEl.scrollHeight}function s(b){e.singleExecProgressWrapEl.hidden=!b,b||(e.singleExecProgressEl.value=0,e.singleExecProgressEl.max=100,e.singleExecProgressTextEl.textContent="")}function r(b){e.singleConfirmBoxEl.hidden=!b,b||(e.singleCbConfirmEl.checked=!1,e.singleConfirmTitleEl.textContent="",e.singleConfirmPreviewEl.innerHTML="")}function a(b,c){e.singleCountEl.textContent=String(b.length),e.singleSelectedCountEl.textContent=String(c.size)}function l(b,c){if(!b.length){e.cbSingleToggleAll.checked=!1,e.cbSingleToggleAll.indeterminate=!1;return}const d=b.filter(p=>c.has(p.id)).length;d===0?(e.cbSingleToggleAll.checked=!1,e.cbSingleToggleAll.indeterminate=!1):d===b.length?(e.cbSingleToggleAll.checked=!0,e.cbSingleToggleAll.indeterminate=!1):(e.cbSingleToggleAll.checked=!1,e.cbSingleToggleAll.indeterminate=!0)}function u(b){const{chats:c,selected:d,isBusy:p,onToggleChat:o}=b;e.singleListEl.innerHTML="";for(const T of c){const m=document.createElement("li");m.className="item",m.dataset.id=T.id;const f=document.createElement("div");f.className="left";const y=document.createElement("input");y.type="checkbox",y.className="deleteCb",y.checked=d.has(T.id),y.addEventListener("change",()=>{if(p()){y.checked=d.has(T.id);return}o(T.id,y.checked),m.classList.toggle("selected",y.checked)}),f.appendChild(y);const I=document.createElement("div");I.className="mid";const S=document.createElement("div");S.className="title",S.textContent=T.title||"Untitled";const C=document.createElement("a");C.className="link",C.href=T.href,C.textContent=T.href,C.target="_blank",C.rel="noreferrer",I.appendChild(S),I.appendChild(C),m.appendChild(f),m.appendChild(I),m.classList.toggle("selected",d.has(T.id)),e.singleListEl.appendChild(m)}a(c,d),l(c,d)}function P(b,c){const d=b.filter(m=>c.includes(m.id)),p=d.length,o=d.slice(0,5);e.singleConfirmTitleEl.textContent=`You are about to delete: ${p} chat${p===1?"":"s"}`,e.singleConfirmPreviewEl.innerHTML="";for(const m of o){const f=document.createElement("li");f.textContent=m.title||"Untitled",e.singleConfirmPreviewEl.appendChild(f)}const T=p-o.length;if(T>0){const m=document.createElement("li");m.textContent=`and ${T} more…`,e.singleConfirmPreviewEl.appendChild(m)}e.singleCbConfirmEl.checked=!1,e.singleBtnConfirmExecute.textContent=`Yes, delete ${p}`}return{setStatus:t,writeExecOut:i,appendExecOut:n,showExecProgress:s,showConfirm:r,updateCounts:a,updateToggleAllState:l,renderList:u,renderConfirmPreview:P}}const ye="cgo_stats_v1";function re(e){const t=Number(e);return Number.isFinite(t)&&t>0?Math.floor(t):0}async function _e(){try{const e=await ee(ye),t=(e==null?void 0:e[ye])||{};return{deletedChats:re(t.deletedChats),deletedProjects:re(t.deletedProjects)}}catch{return{deletedChats:0,deletedProjects:0}}}async function dt(e){await te({[ye]:{deletedChats:re(e.deletedChats),deletedProjects:re(e.deletedProjects)}})}async function ut(e=1){const t=await _e(),i={...t,deletedChats:t.deletedChats+Math.max(1,re(e))};return await dt(i),i}async function cs(e=1){const t=await _e(),i={...t,deletedProjects:t.deletedProjects+Math.max(1,re(e))};return await dt(i),i}function os(e,t,i){const n=is(),s=ss(e);let r=null,a=0,l=0,u=0,P=!1,b=0,c=50;function d(){var j;const g=typeof i.getScopeUpdatedSince=="function"?i.getScopeUpdatedSince():"";return g||((j=e.scopeDateEl)==null?void 0:j.value)||""}function p(g){r=null,a=0,l=0,u=g,b=0,s.showExecProgress(!0),e.singleExecProgressEl.max=Math.max(1,g),e.singleExecProgressEl.value=0,e.singleExecProgressTextEl.textContent=`Starting… 0/${g}`,s.setStatus("Deleting chats…")}function o(g,j,v,z,h){e.singleExecProgressEl.max=Math.max(1,j),e.singleExecProgressEl.value=Math.min(g,j),e.singleExecProgressTextEl.textContent=`Deleting ${g}/${j} · ok ${v} · failed ${z} · last ${_(h)}`}function T(g){s.setStatus(""),e.singleExecProgressTextEl.textContent=g}async function m(){await be(e,async()=>{s.showConfirm(!1),s.writeExecOut(""),s.setStatus("Loading single chats…");const g=F(e.singleLimitEl.value,1,5e4,50),j=d();Z({scope:"single",kind:"debug",message:"listSingleChats:start",meta:{scopeYmd:j,limit:g,pageSize:50}});const v=await Q({type:B.LIST_ALL_CHATS,limit:g,pageSize:50,scopeYmd:j}).catch(h=>(Z({scope:"single",kind:"error",message:"listSingleChats:runtimeSend failed",error:String((h==null?void 0:h.message)||h)}),null));if(!v){s.setStatus("Loading single chats failed (no response).");return}if(!v.ok){s.setStatus(`Loading single chats failed: ${v.error}`),Z({scope:"single",kind:"error",message:"listSingleChats:failed",error:String(v.error||"unknown error")});return}const z=v.conversations||[];n.setChats(z.filter(h=>!h.gizmoId)),i.setSingleChats(n.chats,{limit:g}),s.renderList({chats:n.chats,selected:n.selected,isBusy:()=>D(),onToggleChat:(h,x)=>{n.toggle(h,x),s.updateCounts(n.chats,n.selected),s.updateToggleAllState(n.chats,n.selected)}}),s.setStatus(""),Z({scope:"single",kind:"debug",message:"listSingleChats:done",meta:{chats:n.chats.length,limit:g,scopeYmd:j}})})}function f(){const g=n.getSelectedIds();if(!g.length){s.writeExecOut("Nothing selected.");return}s.renderConfirmPreview(n.chats,g),s.showConfirm(!0)}function y(){const g=n.getSelectedIds();if(!g.length){s.writeExecOut("Nothing selected.");return}s.writeExecOut(""),s.appendExecOut(`EXECUTE: deleting ${g.length} chat(s)…`),p(g.length),U(e,!0),P=!0,Z({scope:"single",kind:"debug",message:"deleteRun:start",meta:{count:g.length}}),Q({type:B.EXECUTE_DELETE,ids:g,throttleMs:600}).catch(j=>{P=!1;const v=String((j==null?void 0:j.message)||j);s.appendExecOut(`✗ Start delete failed: ${v}`),Z({scope:"single",kind:"error",message:"deleteRun:start failed",error:v}),M({kind:"error",scope:"single",message:"Delete run failed to start",ok:!1,error:v}),U(e,!1)})}function I(){if(D()||!n.chats.length)return;const j=n.chats.filter(v=>n.selected.has(v.id)).length===n.chats.length;n.toggleAll(!j),s.renderList({chats:n.chats,selected:n.selected,isBusy:()=>D(),onToggleChat:(v,z)=>{n.toggle(v,z),s.updateCounts(n.chats,n.selected),s.updateToggleAllState(n.chats,n.selected)}})}const S=t.on(g=>{var j;if((g==null?void 0:g.type)===B.EXECUTE_DELETE_PROGRESS){if(!P)return;const v=g;if(r||(r=v.runId),r!==v.runId)return;const z=Number(v.i||0),h=Number(v.total||u),x=String(v.id||""),E=!!v.ok,w=v.status,k=v.error,L=Number(v.attempt||1),O=Number(v.elapsedMs||0),$=Number(v.lastOpMs||0);E?a++:l++,o(z,h,a,l,$);const A=((j=n.chats.find(N=>N.id===x))==null?void 0:j.title)||x.slice(0,8),R=E?`✓ ${A} (${x.slice(0,8)}) — ${w??"OK"} — ${_($)} — elapsed ${_(O)}`:`✗ ${A} (${x.slice(0,8)}) — ${w??"ERR"} — attempt ${L} — ${k||"failed"} — elapsed ${_(O)}`;s.appendExecOut(R),!E&&b<c&&(b++,M({kind:"error",scope:"single",message:`Delete chat failed: ${A} (${x.slice(0,8)})`,ok:!1,status:w,error:k||"failed",chatId:x,chatTitle:A,meta:{attempt:L,elapsedMs:O,lastOpMs:$}})),E&&(n.removeChat(x),i.removeChat(x),ut(1),s.renderList({chats:n.chats,selected:n.selected,isBusy:()=>D(),onToggleChat:(N,J)=>{n.toggle(N,J),s.updateCounts(n.chats,n.selected),s.updateToggleAllState(n.chats,n.selected)}}));return}if((g==null?void 0:g.type)===B.EXECUTE_DELETE_DONE){if(!P)return;const v=g;if(r||(r=v.runId),r!==v.runId)return;const z=Number(v.total||u),h=Number(v.okCount||a),x=Number(v.failCount||l),E=Number(v.elapsedMs||0);M({kind:"run",scope:"single",message:`Delete run finished: ok ${h}/${z}, failed ${x}, elapsed ${_(E)}`,ok:x===0,meta:{total:z,okCount:h,failCount:x,elapsedMs:E}}),Z({scope:"single",kind:"debug",message:"deleteRun:done",meta:{total:z,okCount:h,failCount:x,elapsedMs:E}}),b=0,T(`Done · ok ${h}/${z} · failed ${x} · elapsed ${_(E)}`),U(e,!1),r=null,a=0,l=0,u=0,P=!1;return}});function C(){e.cbSingleToggleAll.addEventListener("change",()=>I()),e.btnSingleDelete.addEventListener("click",()=>{D()||f()}),e.singleBtnCancelExecute.addEventListener("click",()=>s.showConfirm(!1)),e.singleBtnConfirmExecute.addEventListener("click",()=>{if(!D()){if(!e.singleCbConfirmEl.checked){s.writeExecOut("Blocked: tick the confirmation checkbox.");return}s.showConfirm(!1),y()}})}return{id:"single",refresh(){D()||m().catch(g=>s.setStatus(`Error: ${String((g==null?void 0:g.message)||g)}`))},mount(){},unmount(){},bind:C,dispose(){S()}}}function as(){let e=[];const t=new Set,i=new Set;function n(){t.clear(),i.clear()}function s(c){e=c;const d=new Set(e.map(o=>o.gizmoId));for(const o of Array.from(t))d.has(o)||t.delete(o);const p=new Set(e.flatMap(o=>(o.conversations||[]).map(T=>T.id)));for(const o of Array.from(i))p.has(o)||i.delete(o)}function r(c){return(c.conversations||[]).map(d=>d.id)}function a(c,d){if(d){t.add(c.gizmoId);for(const p of r(c))i.add(p)}else{t.delete(c.gizmoId);for(const p of r(c))i.delete(p)}}function l(c,d){d?i.add(c):i.delete(c)}function u(c){i.delete(c);for(const d of e)d.conversations=(d.conversations||[]).filter(p=>p.id!==c)}function P(c){t.delete(c),e=e.filter(d=>d.gizmoId!==c)}function b(){return e.reduce((c,d)=>c+(d.conversations||[]).length,0)}return{get projects(){return e},selectedProjectIds:t,selectedProjectChatIds:i,clearSelections:n,setProjects:s,toggleProjectSelection:a,toggleChatSelection:l,removeChatEverywhere:u,removeProject:P,getTotalChats:b}}function rs(e){const t=new Set;function i(){t.clear(),e.projectsListEl.querySelectorAll("li.projectCard").forEach(p=>{const o=p.dataset.gizmoId||"",T=p.querySelector("details");o&&(T!=null&&T.open)&&t.add(o)})}function n(){e.projectsListEl.querySelectorAll("li.projectCard").forEach(p=>{const o=p.dataset.gizmoId||"",T=p.querySelector("details");o&&T&&(T.open=t.has(o))})}function s(p){e.projectsStatusEl.textContent=p}function r(p){e.projectsExecOutEl.textContent=p}function a(p){const o=e.projectsExecOutEl.textContent||"";e.projectsExecOutEl.textContent=o?`${o}
${p}`:p,e.projectsExecOutEl.scrollTop=e.projectsExecOutEl.scrollHeight}function l(p){e.projectsChatsExecProgressWrapEl.hidden=!p,p||(e.projectsChatsExecProgressEl.value=0,e.projectsChatsExecProgressEl.max=100,e.projectsChatsExecProgressTextEl.textContent="")}function u(p){e.projectsProjectsExecProgressWrapEl.hidden=!p,p||(e.projectsProjectsExecProgressEl.value=0,e.projectsProjectsExecProgressEl.max=100,e.projectsProjectsExecProgressTextEl.textContent="")}function P(p){e.projectsConfirmBoxEl.hidden=!p,p||(e.projectsCbConfirmEl.checked=!1,e.projectsConfirmTitleEl.textContent="",e.projectsConfirmPreviewEl.innerHTML="")}function b(p){e.projectsCountEl.textContent=String(p.projects.length),e.projectsChatsCountEl.textContent=String(p.totalChats),e.projectsSelectedChatsCountEl.textContent=String(p.selectedChatsCount),e.projectsSelectedProjectsCountEl.textContent=String(p.selectedProjectsCount)}function c(p){var g;const{projects:o,selectedProjectIds:T,selectedProjectChatIds:m,isBusy:f,onToggleProject:y,onToggleChat:I,afterProjectToggle:S,afterChatToggle:C}=p;i(),e.projectsListEl.innerHTML="";for(const j of o){const v=document.createElement("li");v.className="projectCard",v.dataset.gizmoId=j.gizmoId;const z=document.createElement("div");z.className="projectHead";const h=document.createElement("div"),x=document.createElement("div");x.className="title",x.textContent=`${j.title} (${((g=j.conversations)==null?void 0:g.length)||0})`;const E=document.createElement("a");E.className="link",E.href=j.href,E.target="_blank",E.rel="noreferrer",E.textContent=j.href,h.appendChild(x),h.appendChild(E);const w=document.createElement("label");w.className="projectPick";const k=document.createElement("input");k.type="checkbox",k.checked=T.has(j.gizmoId),k.addEventListener("change",()=>{f()&&Z({scope:"projects",kind:"debug",message:"ui:toggleProject while busy",meta:{gizmoId:j.gizmoId,checked:k.checked}}),y(j,k.checked),S()});const L=document.createElement("span");L.textContent="Select project (delete project + its chats)",w.appendChild(k),w.appendChild(L),z.appendChild(h),z.appendChild(w);const O=document.createElement("details"),$=document.createElement("summary");$.textContent="Show conversations",O.appendChild($);const A=document.createElement("ul");A.className="list",A.style.marginTop="8px";for(const R of j.conversations||[]){const N=document.createElement("li");N.className="item",N.style.gridTemplateColumns="28px 1fr";const J=document.createElement("div");J.className="left";const G=document.createElement("input");G.type="checkbox",G.className="deleteCb";const Y=T.has(j.gizmoId);G.checked=Y||m.has(R.id),G.addEventListener("change",()=>{if(T.has(j.gizmoId)){G.checked=!0,f()&&Z({scope:"projects",kind:"debug",message:"ui:toggleChat blocked (project forced) while busy",meta:{gizmoId:j.gizmoId,chatId:R.id}});return}f()&&Z({scope:"projects",kind:"debug",message:"ui:toggleChat while busy",meta:{gizmoId:j.gizmoId,chatId:R.id,checked:G.checked}}),I(j,R.id,G.checked),C()}),J.appendChild(G);const K=document.createElement("div"),V=document.createElement("div");V.className="title",V.textContent=R.title||"Untitled";const X=document.createElement("a");X.className="link",X.href=R.href,X.target="_blank",X.rel="noreferrer",X.textContent=R.href,K.appendChild(V),K.appendChild(X),N.appendChild(J),N.appendChild(K),A.appendChild(N)}O.appendChild(A),v.appendChild(z),v.appendChild(O),e.projectsListEl.appendChild(v)}n()}function d(p){const{projects:o,selectedProjectIds:T,selectedChatIds:m}=p;e.projectsConfirmPreviewEl.innerHTML="";const f=[];T.length&&f.push(`${T.length} project(s)`),m.length&&f.push(`${m.length} chat(s)`),e.projectsConfirmTitleEl.textContent=`You are about to delete: ${f.join(" + ")}`;const y=T.slice(0,5);for(const S of y){const C=o.find(j=>j.gizmoId===S);if(!C)continue;const g=document.createElement("li");g.textContent=`Project: ${C.title}`,e.projectsConfirmPreviewEl.appendChild(g)}if(T.length>y.length){const S=document.createElement("li");S.textContent=`…and ${T.length-y.length} more projects`,e.projectsConfirmPreviewEl.appendChild(S)}const I=m.slice(0,5);for(const S of I){const C=o.flatMap(j=>j.conversations||[]).find(j=>j.id===S),g=document.createElement("li");g.textContent=`Chat: ${(C==null?void 0:C.title)||S.slice(0,8)}`,e.projectsConfirmPreviewEl.appendChild(g)}if(m.length>I.length){const S=document.createElement("li");S.textContent=`…and ${m.length-I.length} more chats`,e.projectsConfirmPreviewEl.appendChild(S)}e.projectsCbConfirmEl.checked=!1,e.projectsBtnConfirmExecute.textContent="Yes, delete"}return{setStatus:s,writeExecOut:r,appendExecOut:a,showChatsExecProgress:l,showProjectsExecProgress:u,showConfirm:P,updateCounts:b,renderList:c,renderConfirmPreview:d}}function pe(e,t){const i=e.querySelector(t);if(!i)throw new Error(`[createProjectBox] Missing ${t}`);return i}function gt(e){const{context:t,title:i=t==="organize"?"Create new project":"Create a new project",compact:n=t==="organize",namePlaceholder:s="e.g. general",descPlaceholder:r=t==="organize"?"Optional description…":"Short description shown in ChatGPT projects…",submitLabel:a=t==="organize"?"Create":"Create project"}=e,l=document.createElement("details");l.className=`createBox${n?" createBox--compact":""}`,l.open=!1,l.innerHTML=`
    <summary>${Ze(i)}</summary>

    <div class="createGrid">
      <label class="fieldBlock">
        <span>Project name</span>
        <input data-role="name" type="text" autocomplete="off" maxlength="80" placeholder="${Fe(s)}" />
      </label>

      <label class="fieldBlock">
        <span>Description (optional)</span>
        <textarea data-role="desc" rows="${n?"2":"3"}" placeholder="${Fe(r)}"></textarea>
      </label>

      <div class="row createActions">
        <button data-role="submit" type="button" class="subtle">${Ze(a)}</button>
        <span data-role="status" class="status"></span>
      </div>
    </div>
  `;const u=pe(l,'[data-role="name"]'),P=pe(l,'[data-role="desc"]'),b=pe(l,'[data-role="submit"]'),c=pe(l,'[data-role="status"]');function d(){return{name:u.value.trim(),description:P.value.trim()}}function p(y){u.disabled=y,P.disabled=y,b.disabled=y}function o(y){c.textContent=y}function T(){c.textContent=""}function m(){u.value="",P.value="",T()}function f(){T();const{name:y,description:I}=d();if(!y){o("Name is required."),u.focus();return}const S={name:y,description:I,context:t};l.dispatchEvent(new CustomEvent("cgo:createProject",{bubbles:!0,detail:S}))}return b.addEventListener("click",f),u.addEventListener("keydown",y=>{y.key==="Enter"&&(y.preventDefault(),f())}),{el:l,setBusy:p,setStatus:o,clearStatus:T,reset:m,getValue:d}}function Ze(e){return e.replace(/[&<>"']/g,t=>{switch(t){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case"'":return"&#39;";default:return t}})}function Fe(e){return Ze(e)}function ls(e,t,i){const n=as(),s=rs(e);let r=null,a=0,l=0,u=0,P=!1,b=null,c=0,d=0,p=0,o=0,T=50;function m(){var x;const h=typeof i.getScopeUpdatedSince=="function"?i.getScopeUpdatedSince():"";return h||((x=e.scopeDateEl)==null?void 0:x.value)||""}function f(){s.updateCounts({projects:n.projects,totalChats:n.getTotalChats(),selectedChatsCount:n.selectedProjectChatIds.size,selectedProjectsCount:n.selectedProjectIds.size})}function y(){s.renderList({projects:n.projects,selectedProjectIds:n.selectedProjectIds,selectedProjectChatIds:n.selectedProjectChatIds,isBusy:()=>D(),onToggleProject:(h,x)=>n.toggleProjectSelection(h,x),onToggleChat:(h,x,E)=>n.toggleChatSelection(x,E),afterProjectToggle:()=>{f(),y()},afterChatToggle:()=>{f()}}),f()}function I(){const h=Array.from(n.selectedProjectChatIds),x=Array.from(n.selectedProjectIds);if(!h.length&&!x.length){s.writeExecOut("Nothing selected."),s.showConfirm(!1);return}s.renderConfirmPreview({projects:n.projects,selectedProjectIds:x,selectedChatIds:h}),s.showConfirm(!0)}function S(){s.showChatsExecProgress(!1)}function C(){s.showProjectsExecProgress(!1)}async function g(){await be(e,async()=>{s.showConfirm(!1),s.writeExecOut(""),s.setStatus("Projects loading… 0 project(s), 0 chat(s)");const h=F(e.projectsLimitEl.value,1,5e3,50),x=F(e.projectsChatsLimitEl.value,1,5e3,200),E=m(),w=5,k=F(e.projectsChatsLimitEl.value,1,5e4,5e3);Z({scope:"projects",kind:"debug",message:"listProjects:start",meta:{limitProjects:h,uiMaxChatsPerProject:x,conversationsPerGizmo:w,perProjectLimit:k,scopeYmd:E}});const L=await Q({type:B.LIST_GIZMO_PROJECTS,limit:h,conversationsPerGizmo:w,perProjectLimit:k,scopeYmd:E}).catch($=>(Z({scope:"projects",kind:"error",message:"listProjects:runtimeSend failed",error:String(($==null?void 0:$.message)||$)}),null));if(!L){s.setStatus("Projects loading failed (no response).");return}if(!L.ok){s.setStatus(`Projects loading failed: ${L.error}`),Z({scope:"projects",kind:"error",message:"listProjects:failed",error:String(L.error||"unknown error")});return}const O=L.projects||[];n.setProjects(O.map($=>({...$,conversations:($.conversations||[]).slice(0,x)}))),i.setProjects(n.projects,{limitProjects:h,chatsPerProject:x}),y(),s.setStatus(""),Z({scope:"projects",kind:"debug",message:"listProjects:done",meta:{projects:n.projects.length,chats:n.getTotalChats(),limitProjects:h,uiMaxChatsPerProject:x}})})}function j(){if(D())return;const h=Array.from(n.selectedProjectChatIds),x=Array.from(n.selectedProjectIds);if(!h.length&&!x.length){s.writeExecOut("Nothing selected.");return}if(!e.projectsCbConfirmEl.checked){s.writeExecOut("Blocked: tick the confirmation checkbox.");return}s.showConfirm(!1),s.writeExecOut(""),S(),C(),o=0,U(e,!0),Z({scope:"projects",kind:"debug",message:"deleteRuns:start",meta:{selectedChats:h.length,selectedProjects:x.length}}),h.length&&(r=null,a=0,l=0,u=h.length,P=!0,s.showChatsExecProgress(!0),e.projectsChatsExecProgressEl.max=u||1,e.projectsChatsExecProgressEl.value=0,e.projectsChatsExecProgressTextEl.textContent=`Starting chat delete… 0/${u}`,Q({type:B.EXECUTE_DELETE,ids:h}).catch(E=>{const w=String((E==null?void 0:E.message)||E);Z({scope:"projects",kind:"error",message:"deleteChats:start failed",error:w}),s.appendExecOut(`✗ Start chat delete failed: ${w}`),x.length||(u=0,r=null,P=!1,U(e,!1))})),x.length&&(b=null,c=0,d=0,p=x.length,s.showProjectsExecProgress(!0),e.projectsProjectsExecProgressEl.max=p||1,e.projectsProjectsExecProgressEl.value=0,e.projectsProjectsExecProgressTextEl.textContent=`Starting project delete… 0/${p}`,Q({type:B.DELETE_PROJECTS,gizmoIds:x}).catch(E=>{const w=String((E==null?void 0:E.message)||E);Z({scope:"projects",kind:"error",message:"deleteProjects:start failed",error:w}),s.appendExecOut(`✗ Start project delete failed: ${w}`),h.length||(p=0,b=null,U(e,!1))})),n.clearSelections(),f(),y()}const v=t.on(h=>{var x;if((h==null?void 0:h.type)===B.EXECUTE_DELETE_PROGRESS){if(!P)return;const E=h;if(r||(r=E.runId),r!==E.runId)return;const w=Number(E.i||0),k=Number(E.total||u),L=String(E.id||""),O=!!E.ok,$=E.status,A=E.error,R=Number(E.attempt||1),N=Number(E.elapsedMs||0),J=Number(E.lastOpMs||0);O?a++:l++,e.projectsChatsExecProgressEl.max=k||u||1,e.projectsChatsExecProgressEl.value=Math.min(w,k||u||1),e.projectsChatsExecProgressTextEl.textContent=`Deleting chats ${w}/${k} · ok ${a} · failed ${l} · last ${_(J)}`;let G=L.slice(0,8);for(const K of n.projects){const V=(K.conversations||[]).find(X=>X.id===L);if(V!=null&&V.title){G=V.title;break}}const Y=O?`✓ ${G} (${L.slice(0,8)}) — ${$??"OK"} — ${_(J)} — elapsed ${_(N)}`:`✗ ${G} (${L.slice(0,8)}) — ${$??"ERR"} — attempt ${R} — ${A||"failed"} — elapsed ${_(N)}`;s.appendExecOut(Y),!O&&o<T&&(o++,M({kind:"error",scope:"projects",message:`Delete chat failed: ${G} (${L.slice(0,8)})`,ok:!1,status:$,error:A||"failed",chatId:L,chatTitle:G,meta:{attempt:R,elapsedMs:N,lastOpMs:J}})),O&&(i.removeChat(L),n.setProjects(n.projects.map(K=>({...K,conversations:(K.conversations||[]).filter(V=>V.id!==L)}))),ut(1),f(),y());return}if((h==null?void 0:h.type)===B.EXECUTE_DELETE_DONE){if(!P)return;const E=h;if(r||(r=E.runId),r!==E.runId)return;const w=Number(E.total||u),k=Number(E.okCount||a),L=Number(E.failCount||l),O=Number(E.elapsedMs||0);M({kind:"run",scope:"projects",message:`Chat delete run finished: ok ${k}/${w}, failed ${L}, elapsed ${_(O)}`,ok:L===0,meta:{total:w,okCount:k,failCount:L,elapsedMs:O}}),e.projectsChatsExecProgressTextEl.textContent=`Done · ok ${k}/${w} · failed ${L} · elapsed ${_(O)}`,r=null,a=0,l=0,u=0,P=!1,!b&&p===0&&U(e,!1);return}if((h==null?void 0:h.type)===B.DELETE_PROJECTS_PROGRESS){const E=h;if(b||(b=E.runId),b!==E.runId)return;const w=Number(E.i||0),k=Number(E.total||p),L=String(E.gizmoId||""),O=!!E.ok,$=E.status,A=E.error,R=Number(E.elapsedMs||0),N=Number(E.lastOpMs||0);O?c++:d++,e.projectsProjectsExecProgressEl.max=k||p||1,e.projectsProjectsExecProgressEl.value=Math.min(w,k||p||1),e.projectsProjectsExecProgressTextEl.textContent=`Deleting projects ${w}/${k} · ok ${c} · failed ${d} · last ${_(N)}`;const J=((x=n.projects.find(Y=>Y.gizmoId===L))==null?void 0:x.title)||L,G=O?`✓ ${J} (${L}) — ${$??"OK"} — ${_(N)} — elapsed ${_(R)}`:`✗ ${J} (${L}) — ${$??"ERR"} — ${A||"failed"} — elapsed ${_(R)}`;s.appendExecOut(G),!O&&o<T&&(o++,M({kind:"error",scope:"projects",message:`Delete project failed: ${J} (${L})`,ok:!1,status:$,error:A||"failed",meta:{elapsedMs:R,lastOpMs:N}})),O&&(i.removeProject(L),n.setProjects(n.projects.filter(Y=>Y.gizmoId!==L)),cs(1),f(),y());return}if((h==null?void 0:h.type)===B.DELETE_PROJECTS_DONE){const E=h;if(b||(b=E.runId),b!==E.runId)return;const w=Number(E.total||p),k=Number(E.okCount||c),L=Number(E.failCount||d),O=Number(E.elapsedMs||0);M({kind:"run",scope:"projects",message:`Project delete run finished: ok ${k}/${w}, failed ${L}, elapsed ${_(O)}`,ok:L===0,meta:{total:w,okCount:k,failCount:L,elapsedMs:O}}),e.projectsProjectsExecProgressTextEl.textContent=`Done · ok ${k}/${w} · failed ${L} · elapsed ${_(O)}`,o=0,b=null,c=0,d=0,p=0,!r&&u===0&&U(e,!1);return}});function z(){e.btnProjectsDelete.addEventListener("click",()=>{D()||(s.writeExecOut(""),I())}),e.projectsBtnCancelExecute.addEventListener("click",()=>s.showConfirm(!1)),e.projectsBtnConfirmExecute.addEventListener("click",()=>{D()||j()});const h=gt({context:"projects"});e.mountCreateProjectProjectsEl.replaceChildren(h.el),h.el.addEventListener("cgo:createProject",x=>{var w,k;const E=x;Z({scope:"projects",kind:"debug",message:"ui:createProject click",meta:{context:(w=E.detail)==null?void 0:w.context,name:(k=E.detail)==null?void 0:k.name,busy:D()}}),be(e,async()=>{var $;const{name:L,description:O}=E.detail;h.setBusy(!0),h.setStatus("Creating…"),Z({scope:"projects",kind:"debug",message:"createProject:start",meta:{name:L,hasDescription:!!O}});try{Z({scope:"projects",kind:"debug",message:"createProject:runtimeSend CREATE_PROJECT",meta:{name:L,hasDescription:!!O,busy:D()}});const A=await Q({type:B.CREATE_PROJECT,name:L,description:O,prompt_starters:[]});if(!A){h.setStatus("Create failed (no response)."),M({kind:"error",scope:"projects",message:`Create project failed: ${L} (no response)`,ok:!1});return}if(!A.ok){h.setStatus(`Create failed: ${A.error||"unknown error"}`),M({kind:"error",scope:"projects",message:`Create project failed: ${L}`,ok:!1,error:A.error||"unknown error"});return}h.setStatus("Created."),h.reset();const R={gizmoId:A.gizmoId,title:A.title||L,href:A.href||"#",conversations:[],extra:{localOnly:!0,createdAt:Date.now()}},N=i.getSnapshot();i.insertProject(R,{limitProjects:N.meta.projectsLimit??F(e.projectsLimitEl.value,1,5e3,50),chatsPerProject:N.meta.projectsChatsLimit??F(e.projectsChatsLimitEl.value,1,5e3,200)}),n.setProjects(i.getSnapshot().projects),y(),M({kind:"run",scope:"projects",message:`Created project: ${R.title} (${R.gizmoId})`,ok:!0,meta:{gizmoId:R.gizmoId}})}catch(A){const R=String((A==null?void 0:A.message)||A);h.setStatus(`Create failed: ${R}`),M({kind:"error",scope:"projects",message:`Create project failed: ${(($=E.detail)==null?void 0:$.name)||"unknown"}`,ok:!1,error:R}),Z({scope:"projects",kind:"error",message:"createProject:exception",error:R})}finally{h.setBusy(!1)}})})}return{id:"projects",refresh(){D()||g().catch(h=>s.setStatus(`Error: ${String((h==null?void 0:h.message)||h)}`))},mount(){},unmount(){},bind:z,dispose(){v()}}}function ds(){let e=[],t=[],i="all",n="",s="";const r=new Set;let a=null;function l(f){e=f.singleChats||[],t=f.projects||[];const y=new Set;for(const I of e)y.add(I.id);for(const I of t)for(const S of I.conversations||[])y.add(S.id);for(const I of Array.from(r))y.has(I)||r.delete(I);a&&(t.some(S=>S.gizmoId===a)||(a=null))}function u(f){i=f}function P(f){n=f||""}function b(f){s=f||""}function c(f,y){y?r.add(f):r.delete(f)}function d(f){a=f}function p(){a=null}function o(){return a&&t.find(f=>f.gizmoId===a)||null}function T(){const f=[];if(i==="all"||i==="single")for(const I of e)f.push({...I,origin:"single"});if(i==="all"||i==="projects")for(const I of t)for(const S of I.conversations||[])f.push({...S,origin:"project",projectId:I.gizmoId,projectTitle:I.title});const y=n.trim().toLowerCase();return y?f.filter(I=>{const S=(I.title||"").toLowerCase(),C=(I.href||"").toLowerCase(),g=(I.projectTitle||"").toLowerCase();return S.includes(y)||C.includes(y)||g.includes(y)}):f}function m(){const f=s.trim().toLowerCase();return f?t.filter(y=>(y.title||"").toLowerCase().includes(f)):t}return{setFromCache:l,get sourceMode(){return i},setSourceMode:u,setFilter:P,setProjectFilter:b,selectedChatIds:r,toggleChat:c,get targetProjectId(){return a},setTargetProject:d,clearTargetProject:p,getTargetProject:o,buildSourceChats:T,buildProjects:m}}function us(e){function t(d){e.btnOrganizeMove.disabled=!d,e.organizeBtnConfirmExecute.disabled=!d,e.organizeBtnCancelExecute.disabled=!d,e.organizeSourceEl.disabled=!d,e.organizeFilterEl.disabled=!d,e.organizeProjectFilterEl.disabled=!d,e.cbOrganizeToggleAll.disabled=!d,e.btnOrganizeClearTarget.disabled=!d}function i(d){e.organizeSourceStatusEl.textContent=d}function n(d){e.organizeProjectsStatusEl.textContent=d}function s(d){e.organizeSourceCountEl.textContent=String(d.sourceCount),e.organizeSelectedCountEl.textContent=String(d.selectedCount),e.organizeProjectsCountEl.textContent=String(d.projectsCount),e.organizeTargetLabelEl.textContent=d.targetLabel||"—"}function r(d){e.organizeExecOutEl.textContent=d}function a(d){const p=e.organizeExecOutEl.textContent||"";e.organizeExecOutEl.textContent=p?`${p}
${d}`:d,e.organizeExecOutEl.scrollTop=e.organizeExecOutEl.scrollHeight}function l(d){e.organizeExecProgressWrapEl.hidden=!d,d||(e.organizeExecProgressEl.value=0,e.organizeExecProgressEl.max=100,e.organizeExecProgressTextEl.textContent="")}function u(d){e.organizeConfirmBoxEl.hidden=!d,d||(e.organizeCbConfirmEl.checked=!1,e.organizeConfirmTitleEl.textContent="",e.organizeConfirmPreviewEl.innerHTML="")}function P(d){e.organizeSourceListEl.innerHTML="";for(const p of d.chats){const o=document.createElement("li");o.className="item",o.style.gridTemplateColumns="28px 1fr";const T=document.createElement("div");T.className="left";const m=document.createElement("input");m.type="checkbox",m.checked=d.selectedIds.has(p.id),m.addEventListener("change",()=>{d.isBusy()||d.onToggle(p.id,m.checked)}),T.appendChild(m);const f=document.createElement("div"),y=document.createElement("div");y.className="title",y.textContent=p.title||"Untitled";const I=document.createElement("div");I.className="muted",I.style.fontSize="12px",I.textContent=p.origin==="single"?"Single chat":`Project chat · ${p.projectTitle||p.projectId||"—"}`;const S=document.createElement("a");S.className="link",S.href=p.href,S.target="_blank",S.rel="noreferrer",S.textContent=p.href,f.appendChild(y),f.appendChild(I),f.appendChild(S),o.appendChild(T),o.appendChild(f),e.organizeSourceListEl.appendChild(o)}}function b(d){e.organizeProjectListEl.innerHTML="";for(const p of d.projects){const o=document.createElement("li");o.className="item",o.style.gridTemplateColumns="28px 1fr";const T=document.createElement("div");T.className="left";const m=document.createElement("input");m.type="radio",m.name="organizeTargetProject",m.checked=d.targetProjectId===p.gizmoId,m.addEventListener("change",()=>{d.isBusy()||m.checked&&d.onPick(p.gizmoId)}),T.appendChild(m);const f=document.createElement("div"),y=document.createElement("div");y.className="title",y.textContent=p.title||"Untitled project";const I=document.createElement("div");I.className="muted",I.style.fontSize="12px",I.textContent=`${(p.conversations||[]).length} chat(s) loaded`;const S=document.createElement("a");S.className="link",S.href=p.href,S.target="_blank",S.rel="noreferrer",S.textContent=p.href,f.appendChild(y),f.appendChild(I),f.appendChild(S),o.appendChild(T),o.appendChild(f),e.organizeProjectListEl.appendChild(o)}}function c(d){e.organizeConfirmPreviewEl.innerHTML="",e.organizeConfirmTitleEl.textContent=`Move ${d.selectedChats.length} chat(s) → “${d.target.title||"Untitled project"}”`;const p=d.selectedChats.slice(0,5);for(const o of p){const T=document.createElement("li");T.textContent=o.title||o.id.slice(0,8),e.organizeConfirmPreviewEl.appendChild(T)}if(d.selectedChats.length>p.length){const o=document.createElement("li");o.textContent=`…and ${d.selectedChats.length-p.length} more`,e.organizeConfirmPreviewEl.appendChild(o)}e.organizeCbConfirmEl.checked=!1,e.organizeBtnConfirmExecute.textContent="Yes, move"}return{setActionsEnabled:t,setSourceStatus:i,setProjectsStatus:n,setCounts:s,writeExecOut:r,appendExecOut:a,showExecProgress:l,showConfirm:u,renderSourceList:P,renderProjectList:b,renderConfirmPreview:c}}function gs(e,t,i){const n=ds(),s=us(e);let r=null,a=null,l=0,u=0,P=0,b=0,c=50;function d(C){a=null,l=0,u=0,P=C,b=0,(async()=>{await oe(),c=ae().failureLogsPerRun})().catch(()=>null),s.setActionsEnabled(!1),s.showExecProgress(!0),e.organizeExecProgressEl.max=C,e.organizeExecProgressEl.value=0,e.organizeExecProgressTextEl.textContent=`Moving chats… 0/${C}`,s.writeExecOut(""),s.appendExecOut("EXECUTE MOVE (about to run)")}function p(){const C=i.getSnapshot();n.setFromCache({singleChats:C.singleChats||[],projects:C.projects||[]})}function o(){s.setActionsEnabled(!D()),p();const C=n.buildSourceChats(),g=n.buildProjects(),j=n.getTargetProject();s.renderSourceList({chats:C,selectedIds:n.selectedChatIds,isBusy:()=>D(),onToggle:(v,z)=>{n.toggleChat(v,z),o()}}),s.renderProjectList({projects:g,targetProjectId:n.targetProjectId,isBusy:()=>D(),onPick:v=>{n.setTargetProject(v),o()}}),s.setCounts({sourceCount:C.length,selectedCount:n.selectedChatIds.size,projectsCount:g.length,targetLabel:(j==null?void 0:j.title)||"—"}),s.setSourceStatus(C.length?"":"No source chats loaded (refresh Single/Projects first)."),s.setProjectsStatus(g.length?"":"No projects loaded (refresh Projects first).")}function T(C){const g=n.buildSourceChats();for(const j of g)n.toggleChat(j.id,C)}function m(C){const g=n.selectedChatIds;return C.filter(j=>g.has(j.id))}function f(){s.writeExecOut(""),s.appendExecOut("Preparing move…"),s.showConfirm(!1);const C=n.getTargetProject();if(!C){s.writeExecOut("Select exactly one destination project.");return}const g=n.buildSourceChats(),j=m(g);if(!j.length){s.writeExecOut("Select at least one chat to move.");return}s.renderConfirmPreview({selectedChats:j,target:C}),s.showConfirm(!0)}function y(C,g){C.length&&(d(C.length),U(e,!0),Z({scope:"organize",kind:"debug",message:"move:start",meta:{idsCount:C.length,gizmoId:g}}),M({kind:"run",scope:"organize",message:`Move run started: ${C.length} chat(s) -> ${g}`,ok:!0,meta:{idsCount:C.length,gizmoId:g}}),Q({type:B.MOVE_CHATS_TO_PROJECT,ids:C,gizmoId:g,throttleMs:400}).catch(j=>{const v=String((j==null?void 0:j.message)||j);Z({scope:"organize",kind:"error",message:"move:start failed",error:v,meta:{idsCount:C.length,gizmoId:g}}),M({kind:"error",scope:"organize",message:"Move run failed to start",ok:!1,error:v,meta:{idsCount:C.length,gizmoId:g}}),s.appendExecOut(`✗ Start move failed: ${v}`),s.setActionsEnabled(!0),s.showExecProgress(!1),U(e,!1)}))}const I=t.on(C=>{if((C==null?void 0:C.type)===B.MOVE_CHATS_TO_PROJECT_PROGRESS){const g=C;if(a||(a=g.runId),a!==g.runId)return;const j=Number(g.i||0),v=Number(g.total||P),z=String(g.id||""),h=!!g.ok,x=g.status,E=g.error,w=Number(g.elapsedMs||0),k=Number(g.lastOpMs||0);h?l++:u++,e.organizeExecProgressEl.max=v,e.organizeExecProgressEl.value=Math.min(j,v),e.organizeExecProgressTextEl.textContent=`Moving ${j}/${v} · ok ${l} · failed ${u} · last ${_(k)}`;const L=h?`✓ ${z.slice(0,8)} — ${x??"OK"} — ${_(k)} — elapsed ${_(w)}`:`✗ ${z.slice(0,8)} — ${x??"ERR"} — ${E||"failed"} — elapsed ${_(w)}`;s.appendExecOut(L),!h&&b<c&&(b++,M({kind:"error",scope:"organize",message:`Move chat failed (${z.slice(0,8)})`,ok:!1,status:x,error:E||"failed",chatId:z,meta:{elapsedMs:w,lastOpMs:k}}));return}if((C==null?void 0:C.type)===B.MOVE_CHATS_TO_PROJECT_DONE){const g=C;if(a||(a=g.runId),a!==g.runId)return;const j=Number(g.total||P),v=Number(g.okCount||l),z=Number(g.failCount||u),h=Number(g.elapsedMs||0);s.setActionsEnabled(!0),s.appendExecOut(""),s.appendExecOut(`DONE · ok ${v}/${j} · failed ${z} · elapsed ${_(h)}`),M({kind:"run",scope:"organize",message:`Move run finished: ok ${v}/${j}, failed ${z}, elapsed ${_(h)}`,ok:z===0,meta:{total:j,okCount:v,failCount:z,elapsedMs:h}}),Z({scope:"organize",kind:"debug",message:"move:done",meta:{total:j,okCount:v,failCount:z,elapsedMs:h}}),s.showExecProgress(!1),U(e,!1);const x=n.getTargetProject(),w=n.buildSourceChats().filter(L=>n.selectedChatIds.has(L.id)),k=w.map(L=>L.id);if(x&&k.length){const L=new Map;for(const O of w)L.set(O.id,{title:O.title,href:O.href});i.moveChatsToProject({ids:k,targetProjectId:x.gizmoId,metaById:L}),Z({scope:"organize",kind:"debug",message:"cache:moveChatsToProject applied",meta:{idsCount:k.length,targetProjectId:x.gizmoId}})}n.selectedChatIds.clear(),o(),s.appendExecOut("Cache updated (no fetch)."),s.appendExecOut("Tip: If ChatGPT’s sidebar doesn’t update instantly, refresh the ChatGPT page."),a=null,l=0,u=0,P=0,b=0;return}});function S(){e.organizeSourceEl.addEventListener("change",()=>{n.setSourceMode(e.organizeSourceEl.value),o()}),e.organizeFilterEl.addEventListener("input",()=>{n.setFilter(e.organizeFilterEl.value),o()}),e.organizeProjectFilterEl.addEventListener("input",()=>{n.setProjectFilter(e.organizeProjectFilterEl.value),o()}),e.cbOrganizeToggleAll.addEventListener("change",()=>{D()||(T(e.cbOrganizeToggleAll.checked),o())}),e.btnOrganizeClearTarget.addEventListener("click",()=>{D()||(n.clearTargetProject(),o())}),e.btnOrganizeMove.addEventListener("click",()=>{D()||f()}),e.organizeBtnCancelExecute.addEventListener("click",()=>s.showConfirm(!1)),e.organizeBtnConfirmExecute.addEventListener("click",()=>{if(D())return;if(!e.organizeCbConfirmEl.checked){s.writeExecOut("Blocked: tick the confirmation checkbox.");return}const g=n.getTargetProject();if(!g){s.writeExecOut("Blocked: select a destination project.");return}const v=n.buildSourceChats().filter(z=>n.selectedChatIds.has(z.id));if(!v.length){s.writeExecOut("Blocked: select at least one chat.");return}s.showConfirm(!1),y(v.map(z=>z.id),g.gizmoId)});const C=gt({context:"organize",compact:!0});e.mountCreateProjectOrganizeEl.replaceChildren(C.el),C.el.addEventListener("cgo:createProject",g=>{const j=g;be(e,async()=>{const{name:v,description:z}=j.detail;C.setBusy(!0),C.setStatus("Creating…"),Z({scope:"organize",kind:"debug",message:"createProject:start",meta:{name:v,hasDescription:!!z}});try{Z({scope:"organize",kind:"debug",message:"createProject:runtimeSend CREATE_PROJECT",meta:{name:v,hasDescription:!!z,busy:D()}});const h=await Q({type:B.CREATE_PROJECT,name:v,description:z,prompt_starters:[]});if(!h){C.setStatus("Create failed (no response)."),M({kind:"error",scope:"organize",message:`Create project failed: ${v} (no response)`,ok:!1});return}if(!h.ok){C.setStatus(`Create failed: ${h.error||"unknown error"}`),M({kind:"error",scope:"organize",message:`Create project failed: ${v}`,ok:!1,error:h.error||"unknown error"});return}C.setStatus("Created."),C.reset();const x={gizmoId:h.gizmoId,title:h.title||v,href:h.href||"#",conversations:[],extra:{localOnly:!0,createdAt:Date.now()}},E=i.getSnapshot();i.insertProject(x,{limitProjects:E.meta.projectsLimit??50,chatsPerProject:E.meta.projectsChatsLimit??200}),n.setTargetProject(x.gizmoId),o(),M({kind:"run",scope:"organize",message:`Created project: ${x.title} (${x.gizmoId})`,ok:!0,meta:{gizmoId:x.gizmoId}}),Z({scope:"organize",kind:"debug",message:"createProject:done",meta:{gizmoId:x.gizmoId}})}catch(h){const x=String((h==null?void 0:h.message)||h);C.setStatus(`Create failed: ${x}`),M({kind:"error",scope:"organize",message:`Create project failed: ${v}`,ok:!1,error:x}),Z({scope:"organize",kind:"error",message:"createProject:exception",error:x})}finally{C.setBusy(!1)}})})}return{id:"organize",refresh(){o()},mount(){o(),r=i.subscribe(()=>o())},unmount(){},bind:S,dispose(){I(),r==null||r(),r=null}}}function Ne(e){return(e||"").toLowerCase().trim()}function me(e){if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0}function ps(e){const[t,i,n]=e.split("-").map(s=>Number(s));return!t||!i||!n?0:new Date(t,i-1,n,0,0,0,0).getTime()}function ms(e){const[t,i,n]=e.split("-").map(s=>Number(s));return!t||!i||!n?0:new Date(t,i-1,n,23,59,59,999).getTime()}function pt(e){const t=[e.title,e.snippet,e.id,e.gizmoId];return Ne(t.filter(Boolean).join(` 
`))}function hs(e,t){const i=[e.title,e.gizmoId,pt(t)];return Ne(i.filter(Boolean).join(` 
`))}function Je(e,t){const i=e.isArchived===!0;return t==="include"?!0:t==="exclude"?!i:i}function he(e,t,i){if(t==="any")return!0;if(!e)return!1;const n=t==="24h"?24*60*60*1e3:t==="7d"?7*24*60*60*1e3:t==="30d"?30*24*60*60*1e3:365*24*60*60*1e3;return e>=i-n}function fe(e,t,i){if(!t&&!i)return!0;if(!e)return!1;if(t){const n=ps(t);if(n&&e<n)return!1}if(i){const n=ms(i);if(n&&e>n)return!1}return!0}function fs(e){const t=Math.max(20,Math.min(300,5e3));let i=null,n="",s={scope:"all",archived:"include",updatedWithin:"any",updatedAfter:"",updatedBefore:"",createdWithin:"any",createdAfter:"",createdBefore:""};function r(c){i=c}function a(c){n=c}function l(c){s={...s,...c}}function u(){return{...s}}function P(){return i?i.singleChats.length>0||i.projects.length>0:!1}function b(){if(!i)return{query:n,totalMatches:0,items:[]};const c=Ne(n),d=Date.now(),p=[];let o=0;const T=y=>{o++,p.length<t&&p.push(y)},m=s.scope==="all"||s.scope==="single",f=s.scope==="all"||s.scope==="project";if(m)for(const y of i.singleChats){if(!Je(y,s.archived))continue;const I=me(y.updateTime);if(!he(I,s.updatedWithin,d)||!fe(I,s.updatedAfter||void 0,s.updatedBefore||void 0))continue;const S=me(y.createTime);he(S,s.createdWithin,d)&&fe(S,s.createdAfter||void 0,s.createdBefore||void 0)&&(!c||pt(y).includes(c))&&T({kind:"single",chat:y})}if(f)for(const y of i.projects)for(const I of y.conversations||[]){if(!Je(I,s.archived))continue;const S=me(I.updateTime);if(!he(S,s.updatedWithin,d)||!fe(S,s.updatedAfter||void 0,s.updatedBefore||void 0))continue;const C=me(I.createTime);if(!he(C,s.createdWithin,d)||!fe(C,s.createdAfter||void 0,s.createdBefore||void 0))continue;const g=hs(y,I);(!c||g.includes(c))&&T({kind:"project",project:y,chat:I})}return{query:n,totalMatches:o,items:p}}return{setSnapshot:r,setQuery:a,setFilters:l,getFilters:u,get query(){return n},hasData:P,search:b,maxResults:t}}function ce(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Ve(e){if(!e)return"";const t=String(e).match(/^(\d{4}-\d{2}-\d{2})/);return t?t[1]:""}function Ts(e){const t=[];e.isArchived===!0&&t.push('<span class="badge badge--arch" title="Archived">A</span>');const i=Ve(e.updateTime);i&&t.push(`<span class="badge badge--date" title="Updated">u:${ce(i)}</span>`);const n=Ve(e.createTime);return n&&t.push(`<span class="badge badge--date" title="Created">c:${ce(n)}</span>`),t.length?`<span class="searchBadges">${t.join("")}</span>`:""}function Es(e){function t(r){e.searchStatusEl.textContent=r}function i(r){const{loaded:a,limits:l}=r;e.searchLoadedSinglesEl.textContent=String(a.singleChats),e.searchLoadedProjectsEl.textContent=String(a.projects),e.searchLoadedProjectChatsEl.textContent=String(a.projectChats);const u=[];typeof l.singleLimit=="number"&&u.push(`single limit ${l.singleLimit}`),typeof l.projectsLimit=="number"&&u.push(`projects limit ${l.projectsLimit}`),typeof l.projectsChatsLimit=="number"&&u.push(`chats/project limit ${l.projectsChatsLimit}`),e.searchInfoLimitsEl.textContent=u.length?`Limits: ${u.join(" · ")}`:""}function n(r){const a=[];for(const l of r){const u=ce(l.chat.title||"(untitled)"),P=ce(l.chat.href),b=l.chat.snippet?`<div class="searchSnippet">${ce(l.chat.snippet)}</div>`:"",c=Ts(l.chat);if(l.kind==="single")a.push(`<li class="item searchItem"><div class="searchLine"><a class="searchTitle" href="${P}" target="_blank" rel="noopener noreferrer">${u}</a>`+c+"</div>"+b+"</li>");else{const d=ce(l.project.title||l.project.gizmoId);a.push(`<li class="item searchItem"><div class="searchLine"><a class="searchTitle" href="${P}" target="_blank" rel="noopener noreferrer">${u}</a><span class="searchProject">(${d})</span>`+c+"</div>"+b+"</li>")}}e.searchResultsEl.innerHTML=a.join("")}function s(r){if(i(r),!r.loaded.totalChats){t("No data loaded yet. Use the Info section to list Single/Projects, then search here."),e.searchResultsEl.innerHTML="";return}if(!r.query.trim()){t("Showing all loaded chats (limited). Type to filter."),n(r.results);return}t(`Results: ${r.results.length}`),n(r.results)}return{setStatus:t,render:s,renderResults:n}}function Cs(e,t,i){const n=fs(),s=Es(e);function r(){const c=i.getSnapshot();n.setSnapshot(c);const d=n.search();e.searchResultsCountEl.textContent=String(d.totalMatches),s.render({loaded:c.counts,limits:{singleLimit:c.meta.singleLimit,projectsLimit:c.meta.projectsLimit,projectsChatsLimit:c.meta.projectsChatsLimit},query:d.query,results:d.items})}const a=i.subscribe(()=>{r()});function l(){const c=e.searchScopeEl.value,d=c==="projects"?"project":c;n.setFilters({scope:d,archived:e.searchArchivedEl.value,updatedWithin:e.searchUpdatedWithinEl.value,updatedAfter:e.searchUpdatedAfterEl.value||"",updatedBefore:e.searchUpdatedBeforeEl.value||"",createdWithin:e.searchCreatedWithinEl.value,createdAfter:e.searchCreatedAfterEl.value||"",createdBefore:e.searchCreatedBeforeEl.value||""})}function u(){l(),n.setQuery(e.searchQueryEl.value||""),r()}function P(){e.searchScopeEl.value="all",e.searchArchivedEl.value="include",e.searchUpdatedWithinEl.value="any",e.searchUpdatedAfterEl.value="",e.searchUpdatedBeforeEl.value="",e.searchCreatedWithinEl.value="any",e.searchCreatedAfterEl.value="",e.searchCreatedBeforeEl.value=""}function b(){e.searchQueryEl.addEventListener("input",()=>u()),e.btnSearchClear.addEventListener("click",()=>{e.searchQueryEl.value="",e.searchQueryEl.focus(),u()}),e.searchScopeEl.addEventListener("change",()=>u()),e.searchArchivedEl.addEventListener("change",()=>u()),e.searchUpdatedWithinEl.addEventListener("change",()=>u()),e.searchUpdatedAfterEl.addEventListener("change",()=>u()),e.searchUpdatedBeforeEl.addEventListener("change",()=>u()),e.searchCreatedWithinEl.addEventListener("change",()=>u()),e.searchCreatedAfterEl.addEventListener("change",()=>u()),e.searchCreatedBeforeEl.addEventListener("change",()=>u()),e.btnSearchResetFilters.addEventListener("click",()=>{P(),u()})}return{id:"search",mount(){const c=i.getSnapshot();if(!((c.counts.singleChats||0)>0||(c.counts.projects||0)>0||(c.counts.projectChats||0)>0)){s.setStatus("No data loaded. Use Scope → Refresh."),e.searchResultsCountEl.textContent="0";return}u()},unmount(){},bind:b,dispose(){a()}}}function Ss(){let e=[],t=0;function i(n){e=n.items,t=n.total}return{get items(){return e},get total(){return t},set:i}}function bs(e){try{return new Date(e).toLocaleString()}catch{return String(e)}}function We(e,t){const i=[];i.push(`Total entries: ${t.total}`),i.push("");for(const n of t.items){const s=typeof n.ok=="boolean"?n.ok?"ok":"fail":"",r=[];typeof n.status=="number"&&r.push(`status=${n.status}`),s&&r.push(s);const a=[n.scope,n.kind].filter(Boolean).join("/");i.push(`[${bs(n.ts)}] ${a}${r.length?` (${r.join(", ")})`:""}`),i.push(`  ${n.message}`),n.error&&i.push(`  error: ${n.error}`),i.push("")}e.textContent=i.join(`
`),e.scrollTop=0}function vs(e){function t(a){e.logsStatusEl.textContent=a}function i(a){e.debugStatusEl.textContent=a}function n(a){e.logsCbDebugEl.checked=a}function s(a){We(e.logsOutEl,{total:a.total,items:a.items.map(l=>({ts:l.ts,message:l.message,scope:l.scope,kind:l.kind,ok:l.ok,status:l.status,error:l.error,meta:l.meta}))})}function r(a){We(e.debugOutEl,{total:a.total,items:a.items.map(l=>({ts:l.ts,message:l.message,scope:l.scope,kind:l.kind,ok:l.ok,status:l.status,error:l.error,meta:l.meta}))})}return{setAuditStatus:t,setDebugStatus:i,setDebugChecked:n,renderAudit:s,renderDebug:r}}async function ys(e){if(!e.cfgTraceScopeEl||!e.cfgStopAfterOutOfScopeEl)return;await oe();const t=ae();e.cfgTraceScopeEl.checked=!!t.traceScope,e.cfgStopAfterOutOfScopeEl.value=String(t.stopAfterOutOfScopeProjects??0)}function js(e,t){const i=Ss(),n=vs(e);async function s(){n.setAuditStatus("Loading…"),U(e,!0);try{const o=F(e.logsLimitEl.value,10,5e3,200),T=await Qi({limit:o,reverse:!0});i.set(T),n.renderAudit({items:i.items,total:i.total}),n.setAuditStatus(`Showing ${i.items.length} (newest first)`)}catch(o){n.setAuditStatus(`Failed: ${(o==null?void 0:o.message)||o}`)}finally{U(e,!1)}}async function r(){n.setDebugStatus("Loading…"),U(e,!0);try{const o=F(e.debugLimitEl.value,10,5e3,200),T=await st({limit:o,reverse:!0});n.renderDebug(T),n.setDebugStatus(`Showing ${T.items.length} (newest first)`)}catch(o){n.setDebugStatus(`Failed: ${(o==null?void 0:o.message)||o}`)}finally{U(e,!1)}}async function a(){const o=await Me();n.setDebugChecked(o)}async function l(o){if(await nt(o),n.setDebugChecked(o),!o){n.setDebugStatus("Debug OFF. Traces wiped."),e.debugOutEl.textContent="";return}n.setDebugStatus("Debug ON."),await r()}async function u(){const o=F(e.logsTrimKeepEl.value,0,5e4,2e3);n.setAuditStatus("Trimming…"),U(e,!0);try{const T=await qi({keepLast:o});await s(),n.setAuditStatus(`Trimmed. Remaining: ${T.total}`)}catch(T){n.setAuditStatus(`Trim failed: ${(T==null?void 0:T.message)||T}`)}finally{U(e,!1)}}async function P(){n.setAuditStatus("Clearing…"),U(e,!0);try{await es(),await s(),n.setAuditStatus("Cleared.")}catch(o){n.setAuditStatus(`Clear failed: ${(o==null?void 0:o.message)||o}`)}finally{U(e,!1)}}async function b(){n.setAuditStatus("Exporting…");try{const o=await ts({pretty:!0}),T=new Blob([o],{type:"application/json"}),m=URL.createObjectURL(T),f=document.createElement("a");f.href=m,f.download=`chatgpt-organizer-audit-${Date.now()}.json`,f.click(),setTimeout(()=>URL.revokeObjectURL(m),1e3),n.setAuditStatus("Exported.")}catch(o){n.setAuditStatus(`Export failed: ${(o==null?void 0:o.message)||o}`)}}async function c(){n.setDebugStatus("Clearing…"),U(e,!0);try{await it(),await r(),n.setDebugStatus("Cleared.")}catch(o){n.setDebugStatus(`Clear failed: ${(o==null?void 0:o.message)||o}`)}finally{U(e,!1)}}async function d(){n.setDebugStatus("Exporting…");try{const o=await ct({pretty:!0}),T=new Blob([o],{type:"application/json"}),m=URL.createObjectURL(T),f=document.createElement("a");f.href=m,f.download=`chatgpt-organizer-debug-${Date.now()}.json`,f.click(),setTimeout(()=>URL.revokeObjectURL(m),1e3),n.setDebugStatus("Exported.")}catch(o){n.setDebugStatus(`Export failed: ${(o==null?void 0:o.message)||o}`)}}function p(){e.btnLogsRefresh.addEventListener("click",()=>{D()||s().catch(()=>{})}),e.btnLogsTrim.addEventListener("click",()=>{D()||u().catch(()=>{})}),e.btnLogsClear.addEventListener("click",()=>{D()||P().catch(()=>{})}),e.btnLogsExport.addEventListener("click",()=>{D()||b().catch(()=>{})}),e.logsCbDebugEl.addEventListener("change",()=>{D()||l(e.logsCbDebugEl.checked).catch(()=>{})}),e.btnDebugRefresh.addEventListener("click",()=>{D()||r().catch(()=>{})}),e.btnDebugClear.addEventListener("click",()=>{D()||c().catch(()=>{})}),e.btnDebugExport.addEventListener("click",()=>{D()||d().catch(()=>{})})}return{id:"logs",bind:p,mount(){a().catch(()=>{}),s().catch(()=>{}),r().catch(()=>{}),ys(e).catch(()=>{})},unmount(){},dispose(){}}}function je(e){if(!e)return 0;const t=Date.parse(e);return Number.isFinite(t)?t:0}function mt(e){if(!e)return"";const t=String(e).match(/^(\d{4}-\d{2}-\d{2})/);return t?t[1]:""}function Is(e){const t=[];for(const i of e.singleChats)t.push(i);for(const i of e.projects)for(const n of i.conversations||[])t.push(n);return t}function Ps(e){let t=0;for(const i of e)i.isArchived===!0&&t++;return t}function xs(e){const t=[];return typeof e.singleLimit=="number"&&t.push(`single limit ${e.singleLimit}`),typeof e.projectsLimit=="number"&&t.push(`projects limit ${e.projectsLimit}`),typeof e.projectsChatsLimit=="number"&&t.push(`chats/project limit ${e.projectsChatsLimit}`),t.length?`Limits: ${t.join(" · ")}`:"Limits: —"}function Ls(e){const t=Number(e.singleUpdatedTs||0),i=Number(e.projectsUpdatedTs||0);return Math.max(t,i)}function ws(e){const t={sameDay:0,d1_2:0,d3_7:0,d8_30:0,d31p:0,unknown:0},i=24*60*60*1e3;for(const n of e){const s=je(n.createTime),r=je(n.updateTime);if(!s||!r||r<s){t.unknown++;continue}const a=Math.floor((r-s)/i);a<=0?t.sameDay++:a<=2?t.d1_2++:a<=7?t.d3_7++:a<=30?t.d8_30++:t.d31p++}return t}function zs(e,t=12){const i=new Map;for(const s of e){const r=mt(s.createTime);r&&i.set(r,(i.get(r)||0)+1)}const n=Array.from(i.entries()).map(([s,r])=>({day:s,count:r}));return n.sort((s,r)=>r.count-s.count||(s.day<r.day?1:-1)),n.slice(0,t)}function ks(e){const t=e.length;let i=0;const n={empty:0,small:0,medium:0,large:0,huge:0},s=e.map(r=>({title:r.title||r.gizmoId,gizmoId:r.gizmoId,chats:(r.conversations||[]).length})).sort((r,a)=>a.chats-r.chats).slice(0,10);for(const r of e){const a=(r.conversations||[]).length;a===0?(i++,n.empty++):a<=5?n.small++:a<=20?n.medium++:a<=100?n.large++:n.huge++}return{projectCount:t,emptyProjects:i,sizeBuckets:n,topProjects:s}}function Os(e){const t=new Map;for(const n of e){const s=mt(n.createTime);s&&t.set(s,(t.get(s)||0)+1)}const i=Array.from(t.entries()).map(([n,s])=>({day:n,count:s}));return i.sort((n,s)=>n.day<s.day?-1:n.day>s.day?1:0),i}function Ds(){let e={deletedChats:0,deletedProjects:0};function t(n){e={deletedChats:Math.max(0,Number(n.deletedChats||0)),deletedProjects:Math.max(0,Number(n.deletedProjects||0))}}function i(n){const s=Is(n),r={singleChats:n.counts.singleChats,projects:n.counts.projects,projectChats:n.counts.projectChats,totalChats:n.counts.totalChats,archivedChats:Ps(s),avgChatsPerProject:n.counts.projects>0?n.counts.projectChats/Math.max(1,n.counts.projects):0,lastCacheUpdateTs:Ls(n.meta),limitsHint:xs(n.meta)};let a=0,l=0;for(const b of s)je(b.createTime)&&a++,je(b.updateTime)&&l++;const u={createdKnown:a,updatedKnown:l,createdPerDayTop:zs(s,12),createdPerDay:Os(s),lifetime:ws(s)},P=ks(n.projects);return{totals:r,activity:u,projects:P,deletes:e}}return{setDeletes:t,compute:i}}function Zs(e){if(!e)return"—";const t=new Date(e),i=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0"),r=String(t.getHours()).padStart(2,"0"),a=String(t.getMinutes()).padStart(2,"0");return`${i}-${n}-${s} ${r}:${a}`}function Bs(e,t=0){return Number.isFinite(e)?t?e.toFixed(t):String(Math.round(e)):"0"}function le(e){return String(e||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function Pe(e,t,i){const n=Math.max(1,...t.map(a=>a.value)),s=(i==null?void 0:i.valueLabel)??(a=>String(a)),r=[];r.push('<div class="statsBars">');for(const a of t){const l=Math.max(0,Math.min(100,a.value/n*100)),u=a.hint?le(a.hint):`${le(a.label)}: ${a.value}`;r.push(`<div class="statsBarItem" title="${u}"><div class="statsBarLabel">${le(a.label)}</div><div class="statsBarTrack"><div class="statsBarFill" style="width:${l.toFixed(1)}%"></div></div><div class="statsBarValue">${le(s(a.value))}</div></div>`)}r.push("</div>"),e.innerHTML=r.join("")}function As(e,t,i){const n=new Map;for(const E of t){const w=String(E.day||"").slice(0,10);/^\d{4}-\d{2}-\d{2}$/.test(w)&&n.set(w,Number(E.count||0))}if(n.size===0){e.innerHTML='<div class="statsHeatmapWrap"><div class="statsHeatmapHeader"><div class="statsHeatmapTitle">Activity</div><div class="statsHeatmapHint">No created timestamps in the retrieved data.</div></div></div>';return}function s(E){const[w,k,L]=E.split("-").map(O=>Number(O));return new Date(w,(k||1)-1,L||1)}function r(E){return`${E.getFullYear()}-${String(E.getMonth()+1).padStart(2,"0")}-${String(E.getDate()).padStart(2,"0")}`}const a=Array.from(n.keys()).sort(),l=a[0],u=a[a.length-1],P=s(l),b=s(u),c=(P.getDay()+6)%7,d=new Date(P);d.setDate(P.getDate()-c);const p=(b.getDay()+6)%7,o=new Date(b);o.setDate(b.getDate()+(6-p));const T=24*60*60*1e3,m=Math.round((o.getTime()-d.getTime())/T)+1,f=Math.ceil(m/7),y=Math.max(8,Math.min(i==null?void 0:i.maxWeeks,260)),I=Math.min(f,y),S=f>I;let C=1;for(let E=0;E<I;E++)for(let w=0;w<7;w++){const k=new Date(d);k.setDate(d.getDate()+E*7+w);const L=r(k),O=n.get(L)||0;O>C&&(C=O)}function g(E){if(E<=0)return 0;const w=E/C;return w<=.25?1:w<=.5?2:w<=.75?3:4}const j=[];let v=0;for(let E=0;E<I;E++)for(let w=0;w<7;w++){const k=new Date(d);k.setDate(d.getDate()+E*7+w);const L=r(k),O=n.get(L)||0;v+=O;const $=`statsHeatCell statsHeat${g(O)}`,A=`${L} · ${O} created`;j.push(`<div class="${$}" title="${le(A)}"></div>`)}const z=new Date(d);z.setDate(d.getDate()+I*7-1);const h=r(d),x=r(z);e.innerHTML=`<div class="statsHeatmapWrap"><div class="statsHeatmapHeader"><div class="statsHeatmapTitle">From ${h} to ${x} · ${I} week(s)</div><div class="statsHeatmapHint">Total created: ${v} · Max/day: ${C}`+(S?` · Showing first ${I}/${f} weeks (increase maxWeeks or scroll)`:"")+`</div></div><div class="statsHeatmapGrid">${j.join("")}</div></div>`}function $s(e){function t(n){e.statsStatusEl.textContent=n}function i(n){const s=n.totals;e.statsSingleChatsEl.textContent=String(s.singleChats),e.statsProjectsEl.textContent=String(s.projects),e.statsProjectChatsEl.textContent=String(s.projectChats),e.statsTotalChatsEl.textContent=String(s.totalChats),e.statsArchivedChatsEl.textContent=String(s.archivedChats),e.statsAvgChatsPerProjectEl.textContent=Bs(s.avgChatsPerProject,1),e.statsLastCacheUpdateEl.textContent=Zs(s.lastCacheUpdateTs),e.statsLimitsHintEl.textContent=s.limitsHint,e.statsDeletedChatsEl.textContent=String(n.deletes.deletedChats),e.statsDeletedProjectsEl.textContent=String(n.deletes.deletedProjects);const r=n.activity;As(e.statsCreatedHeatmapEl,r.createdPerDay,{maxWeeks:104});const a=r.lifetime;Pe(e.statsLifetimeHistEl,[{label:"0d",value:a.sameDay,hint:"Updated the same day it was created"},{label:"1–2d",value:a.d1_2},{label:"3–7d",value:a.d3_7},{label:"8–30d",value:a.d8_30},{label:"31d+",value:a.d31p},{label:"unknown",value:a.unknown,hint:"Missing createTime/updateTime (or invalid order)"}]);const l=n.projects;Pe(e.statsProjectSizeHistEl,[{label:"0",value:l.sizeBuckets.empty,hint:"Empty projects"},{label:"1–5",value:l.sizeBuckets.small},{label:"6–20",value:l.sizeBuckets.medium},{label:"21–100",value:l.sizeBuckets.large},{label:"101+",value:l.sizeBuckets.huge}]),l.topProjects.length?Pe(e.statsTopProjectsEl,l.topProjects.map(u=>({label:u.title,value:u.chats,hint:`${u.title} · ${u.chats} chats`})),{valueLabel:u=>String(u)}):e.statsTopProjectsEl.innerHTML='<div class="muted">No projects loaded.</div>'}return{setStatus:t,render:i}}function Rs(e,t,i){const n=Ds(),s=$s(e);let r=null,a=null;async function l(){const c=await _e();n.setDeletes({deletedChats:c.deletedChats,deletedProjects:c.deletedProjects})}async function u(c){const d=i.getSnapshot(),p=n.compute(d);s.render(p),s.setStatus(c)}function P(){const c=(d,p)=>{p==="local"&&d[ye]&&l().then(()=>u("Updated (storage)")).catch(()=>s.setStatus("Stats storage update failed"))};return Ri(c),()=>Mi(c)}function b(){e.btnStatsRecalc.addEventListener("click",()=>{u("Recalculated").catch(()=>s.setStatus("Recalc failed"))})}return{id:"stats",async mount(){s.setStatus("Loading…"),await l().catch(()=>{}),a||(a=P()),r||(r=i.subscribe(()=>{u("Updated from cache").catch(()=>s.setStatus("Update failed"))})),await u("Ready")},unmount(){},bind:b,dispose(){r&&r(),r=null,a&&a(),a=null}}}const Ms="1.0.0",Be="cgo_api_config",Te={origin:"https://chatgpt.com",pathAuthSession:"/api/auth/session",pathConversations:"/backend-api/conversations",pathConversation:"/backend-api/conversation/{id}",pathGizmosRoot:"/backend-api/gizmos",pathGizmosSidebar:"/backend-api/gizmos/snorlax/sidebar",pathGizmoConversations:"/backend-api/gizmos/{id}/conversations",pathUiConversation:"/c/{id}",pathUiGizmo:"/g/{shortUrl}"};function _s(){let e=!1,t={origin:"https://chatgpt.com"},i={traceScope:!1,stopAfterOutOfScopeProjects:3,actionLogMax:5e3,debugTraceMax:2e3,failureLogsPerRun:50},n=!1,s="",r="",a="";function l(d){e=d}function u(d){t={...t,...d}}function P(d){i={...i,...d}}function b(d){n=d}function c(d){typeof d.general=="string"&&(s=d.general),typeof d.api=="string"&&(r=d.api),typeof d.dev=="string"&&(a=d.dev)}return{get showDevTools(){return e},get api(){return t},get dev(){return i},get debugEnabled(){return n},get generalStatus(){return s},get apiStatus(){return r},get devStatus(){return a},setShowDevTools:l,setApi:u,setDev:P,setDebugEnabled:b,setStatus:c}}function Ns(e){function t(c){e.settingsGeneralStatusEl.textContent=c||""}function i(c){e.apiOriginStatusEl.textContent=c||""}function n(c){e.cfgStatusEl.textContent=c||""}function s(c){e.cfgShowDevToolsEl.checked=c}function r(c){e.tabLogs.classList.toggle("is-hidden",!c),e.tabStats.classList.toggle("is-hidden",!c),e.devConfigDetailsEl.classList.toggle("is-hidden",!c),e.settingsConnectionBoxEl.classList.toggle("is-hidden",!c),c||(e.devConfigDetailsEl.open=!1,e.settingsConnectionBoxEl.open=!1)}function a(c){e.apiOriginEl.value=c.origin||""}function l(c){e.cfgTraceScopeEl.checked=!!c.traceScope,e.cfgStopAfterOutOfScopeEl.value=String(c.stopAfterOutOfScopeProjects??0),e.cfgActionLogMaxEl.value=String(c.actionLogMax??5e3),e.cfgDebugTraceMaxEl.value=String(c.debugTraceMax??2e3),e.cfgFailureLogsPerRunEl.value=String(c.failureLogsPerRun??50)}function u(c){e.logsCbDebugEl.checked=c}function P(c,d){e.settingsVersionEl.textContent=c||"—",e.settingsGitHubLinkEl.href=d||"#",e.settingsGitHubLinkEl.hidden=!d}function b(c){e.cfgShowDevToolsEl.disabled=!1,e.apiOriginEl.disabled=c,e.btnApiOriginReset.disabled=c,e.cfgTraceScopeEl.disabled=c,e.cfgStopAfterOutOfScopeEl.disabled=c,e.cfgActionLogMaxEl.disabled=c,e.cfgDebugTraceMaxEl.disabled=c,e.cfgFailureLogsPerRunEl.disabled=c,e.btnCfgResetDefaults.disabled=c,e.logsCbDebugEl.disabled=c}return{setGeneralStatus:t,setApiStatus:i,setDevStatus:n,setShowDevToolsChecked:s,setDevToolsVisible:r,setApiConfig:a,setDevConfig:l,setDebugEnabledChecked:u,setAbout:P,setBusy:b}}const xe="cgo.settings.showDevTools";function Us(e,t=""){return typeof e=="string"?e:t}function ht(e){const t=(e||"").trim();if(!t)return"";try{const i=new URL(t);return`${i.protocol}//${i.host}`}catch{return""}}async function ft(){const e=await ee([Be]).catch(()=>({})),t=e==null?void 0:e[Be],i=ht(Us(t==null?void 0:t.origin,Te.origin))||Te.origin;return{...Te,...t,origin:i}}async function Hs(e){const i={...await ft(),origin:e};await te({[Be]:i}).catch(()=>null)}async function Ke(e){const t=ot;return typeof t.setEnabled=="function"?(await t.setEnabled(e),{ok:!0}):typeof t.enable=="function"&&typeof t.disable=="function"?(await(e?t.enable():t.disable()),{ok:!0}):{ok:!1,error:"debugTrace has no setEnabled/enable/disable API."}}function Gs(){var e,t;try{const i=(e=globalThis==null?void 0:globalThis.chrome)==null?void 0:e.runtime,n=(t=i==null?void 0:i.getManifest)==null?void 0:t.call(i),s=typeof(n==null?void 0:n.version)=="string"?n.version:"";if(s)return s}catch{}return Ms}function Le(e){return{traceScope:!!e.traceScope,stopAfterOutOfScopeProjects:Number(e.stopAfterOutOfScopeProjects??H.stopAfterOutOfScopeProjects),actionLogMax:Number(e.actionLogMax??H.actionLogMax),debugTraceMax:Number(e.debugTraceMax??H.debugTraceMax),failureLogsPerRun:Number(e.failureLogsPerRun??H.failureLogsPerRun)}}function Fs(e){return{traceScope:!!e.cfgTraceScopeEl.checked,stopAfterOutOfScopeProjects:F(e.cfgStopAfterOutOfScopeEl.value,0,5e3,H.stopAfterOutOfScopeProjects),actionLogMax:F(e.cfgActionLogMaxEl.value,100,5e4,H.actionLogMax),debugTraceMax:F(e.cfgDebugTraceMaxEl.value,100,5e4,H.debugTraceMax),failureLogsPerRun:F(e.cfgFailureLogsPerRunEl.value,0,5e4,H.failureLogsPerRun)}}function Js(e,t){const i=_s(),n=Ns(e);async function s(){const m=await ee([xe]).catch(()=>({}));return(m==null?void 0:m[xe])===!0}async function r(m){await te({[xe]:!!m}).catch(()=>null)}async function a(){const m=await s();i.setShowDevTools(m),n.setShowDevToolsChecked(m),n.setDevToolsVisible(m),Z({scope:"settings",kind:"debug",message:"boot:applyDevToolsVisibility",meta:{showDevTools:m}})}async function l(){n.setBusy(D());const m=await s();i.setShowDevTools(m),n.setShowDevToolsChecked(m),n.setDevToolsVisible(m),await oe().catch(()=>null);const f=ae();i.setDev(Le(f)),n.setDevConfig(i.dev);const y=await ft();i.setApi({origin:y.origin}),n.setApiConfig(i.api);const I=ot,S=typeof I.isEnabled=="function"?!!I.isEnabled():!!I.enabled;i.setDebugEnabled(S),n.setDebugEnabledChecked(S),n.setAbout(Gs()||"—","https://github.com/nathabee/chatgpt-organizer"),n.setGeneralStatus(""),n.setApiStatus(""),n.setDevStatus("")}async function u(){const m=!!e.cfgShowDevToolsEl.checked;i.setShowDevTools(m),n.setDevToolsVisible(m),await r(m),M({kind:"run",scope:"settings",message:m?"Developer tools enabled (Logs/Stats visible).":"Developer tools disabled (Logs/Stats hidden).",ok:!0,meta:{showDevTools:m}}),Z({scope:"settings",kind:"debug",message:"ui:toggle showDevTools",meta:{showDevTools:m}}),n.setGeneralStatus(m?"Developer tools enabled.":"Developer tools disabled."),setTimeout(()=>n.setGeneralStatus(""),1200)}async function P(){const m=e.apiOriginEl.value||"",f=ht(m);if(!f){n.setApiStatus("Invalid origin. Example: https://chatgpt.com");return}n.setApiStatus("Saving…"),await Hs(f),i.setApi({origin:f}),n.setApiConfig(i.api),M({kind:"run",scope:"settings",message:`ChatGPT origin updated: ${f}`,ok:!0,meta:{origin:f}}),Z({scope:"settings",kind:"debug",message:"apiOrigin:updated",meta:{origin:f}}),n.setApiStatus("Saved."),setTimeout(()=>n.setApiStatus(""),1200)}async function b(){e.apiOriginEl.value=Te.origin,await P()}async function c(){const m=Fs(e);n.setDevStatus("Saving…"),await tt(m),i.setDev(Le(m)),n.setDevConfig(i.dev),M({kind:"run",scope:"settings",message:"Developer configuration updated.",ok:!0,meta:m}),Z({scope:"settings",kind:"debug",message:"devConfig:updated",meta:m}),n.setDevStatus("Saved."),setTimeout(()=>n.setDevStatus(""),1200)}async function d(){n.setDevStatus("Resetting…"),await _i(),await oe().catch(()=>null);const m=ae();i.setDev(Le(m)),n.setDevConfig(i.dev);const f=await Ke(!1);f.ok?(i.setDebugEnabled(!1),n.setDebugEnabledChecked(!1)):M({kind:"error",scope:"settings",message:"Dev defaults reset, but failed to reset debug enabled state.",ok:!1,error:f.error||"unknown error"}),M({kind:"run",scope:"settings",message:"Developer configuration reset to defaults (debug disabled).",ok:!0,meta:{...H,debugEnabled:!1}}),n.setDevStatus("Reset."),setTimeout(()=>n.setDevStatus(""),1200)}async function p(){const m=!!e.logsCbDebugEl.checked;n.setDevStatus("Saving…");const f=await Ke(m);if(!f.ok){e.logsCbDebugEl.checked=!m,n.setDevStatus(`Save failed: ${f.error||"unknown error"}`),M({kind:"error",scope:"settings",message:"Failed to change debug trace enabled state.",ok:!1,error:f.error||"unknown error",meta:{enabled:m}});return}i.setDebugEnabled(m),M({kind:"run",scope:"settings",message:m?"Debug trace enabled.":"Debug trace disabled (debug traces cleared).",ok:!0,meta:{enabled:m}}),Z({scope:"settings",kind:"debug",message:"debugTrace:enabledChanged",meta:{enabled:m}}),n.setDevStatus("Saved."),setTimeout(()=>n.setDevStatus(""),1200)}const o=t.on(m=>{});function T(){e.cfgShowDevToolsEl.addEventListener("change",()=>{u()}),e.apiOriginEl.addEventListener("change",()=>{D()||P()}),e.btnApiOriginReset.addEventListener("click",()=>{D()||b()}),e.cfgTraceScopeEl.addEventListener("change",()=>{D()||c()}),e.cfgStopAfterOutOfScopeEl.addEventListener("change",()=>{D()||c()}),e.cfgActionLogMaxEl.addEventListener("change",()=>{D()||c()}),e.cfgDebugTraceMaxEl.addEventListener("change",()=>{D()||c()}),e.cfgFailureLogsPerRunEl.addEventListener("change",()=>{D()||c()}),e.btnCfgResetDefaults.addEventListener("click",()=>{D()||d()}),e.logsCbDebugEl.addEventListener("change",()=>{D()||p()}),a().catch(()=>null)}return{id:"settings",refresh(){l().catch(()=>null)},mount(){l().catch(()=>null)},unmount(){},bind:T,dispose(){o()}}}const we="cgo.scopeUpdatedSince";function Xe(e){return String(e).padStart(2,"0")}function Vs(e){const t=e.getFullYear(),i=Xe(e.getMonth()+1),n=Xe(e.getDate());return`${t}-${i}-${n}`}function Ws(e,t){const i=new Date(e),n=i.getDate();return i.setMonth(i.getMonth()-t),i.getDate()!==n&&i.setDate(0),i}function Ye(e){return/^\d{4}-\d{2}-\d{2}$/.test(e)}function Ks(e){return new Promise(t=>setTimeout(t,e))}async function Qe(e=10*60*1e3){const t=Date.now();for(;D();){if(Date.now()-t>e)return!1;await Ks(120)}return!0}(async()=>{const e=Bi(),t=Fi();t.start();const i=Wi(),n=os(e,t,i),s=ls(e,t,i),r=Cs(e,t,i),a=gs(e,t,i),l=Js(e,t),u=js(e),P=Rs(e,t,i);n.bind(),s.bind(),a.bind(),r.bind(),l.bind(),u.bind(),P.bind();const b=Ji(e,{single:n,projects:s,organize:a,search:r,settings:l,logs:u,stats:P});b.bind(),b.boot(),e.btnListSingle.hidden=!0,e.btnListProjects.hidden=!0,e.btnSearchListSingle.hidden=!0,e.btnSearchListProjects.hidden=!0;let c="";function d(){var g,j,v;const S=i.getSnapshot();return(((g=S.counts)==null?void 0:g.singleChats)??0)+(((j=S.counts)==null?void 0:j.projects)??0)+(((v=S.counts)==null?void 0:v.projectChats)??0)===0}function p(S){const C=i;typeof C.setScopeUpdatedSince=="function"&&C.setScopeUpdatedSince(S)}function o(S){d()?(e.scopeLabelEl.textContent="No data loaded — set scope & refresh",e.scopeLabelEl.classList.add("is-warn")):(e.scopeLabelEl.textContent=S?`Updated since ${S}`:"Updated since —",e.scopeLabelEl.classList.remove("is-warn")),e.scopeDialogEl.open||(e.scopeDateEl.value=S||"")}async function T(){const S=await ee([we]).catch(()=>({})),C=S==null?void 0:S[we];return typeof C=="string"&&Ye(C)?C:Vs(Ws(new Date,3))}async function m(S){await te({[we]:S}).catch(()=>null)}async function f(){D()||(Z({scope:"panel",kind:"debug",message:"refreshAll:start"}),n.refresh(),!await Qe())||(s.refresh(),await Qe(),Z({scope:"panel",kind:"debug",message:"refreshAll:done"}))}function y(){if(!D()){e.scopeDateEl.value=c||"";try{e.scopeDialogEl.showModal()}catch{}}}function I(){try{e.scopeDialogEl.close()}catch{}}c=await T(),p(c),o(c),window.addEventListener("cgo:refreshAll",S=>{var j;const g=((j=S.detail)==null?void 0:j.reason)??"unknown";if(Z({scope:"panel",kind:"debug",message:"event:cgo:refreshAll",meta:{reason:g}}),g!=="user"){Z({scope:"panel",kind:"debug",message:"event:cgo:refreshAll blocked (reason != user)",meta:{reason:g}});return}f().catch(v=>{Z({scope:"panel",kind:"error",message:"refreshAllUsingCurrentScope failed",error:String((v==null?void 0:v.message)||v)})})}),e.btnScopeChange.addEventListener("click",()=>{y()}),e.btnScopeRefresh.addEventListener("click",()=>{f().catch(()=>{})}),e.btnScopeCancel.addEventListener("click",()=>{e.scopeDateEl.value=c||"",I()}),e.btnScopeApply.addEventListener("click",()=>{const S=e.scopeDateEl.value||"";Ye(S)&&(c=S,p(c),o(c),m(c).catch(()=>{}),I(),f().catch(()=>{}))}),e.scopeDialogEl.addEventListener("keydown",S=>{var C;S.key==="Enter"&&((C=S.target)==null?void 0:C.tagName)==="INPUT"&&(S.preventDefault(),e.btnScopeApply.click())}),i.subscribe(()=>{const S=i.getSnapshot();e.scopeLoadedSinglesEl.textContent=String(S.counts.singleChats),e.scopeLoadedProjectsEl.textContent=String(S.counts.projects),e.scopeLoadedProjectChatsEl.textContent=String(S.counts.projectChats),o(c)})})();
