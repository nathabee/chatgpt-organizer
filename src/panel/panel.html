<!doctype html>
<html>

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="./panel.css" />
    <title>ChatGPT Organizer</title>
</head>

<body>
    <div class="wrap">
        <h1>ChatGPT Organizer</h1>

        <div class="tabs" role="tablist" aria-label="CGO Tabs">
            <button id="tabSingle" class="tab is-active" role="tab" aria-selected="true" type="button">
                Single Chats
            </button>

            <button id="tabProjects" class="tab" role="tab" aria-selected="false" type="button">
                Projects
            </button>

            <button id="tabOrganize" class="tab" role="tab" aria-selected="false" type="button">
                Organize
            </button>

            <button id="tabSearch" class="tab" role="tab" aria-selected="false" type="button">
                Search
            </button>

            <button id="tabLogs" class="tab" role="tab" aria-selected="false" type="button">
                Logs
            </button>


            <button id="tabStats" class="tab" role="tab" aria-selected="false" type="button">
                Stats
            </button>
        </div>


        <!-- =========================
         SINGLE CHATS VIEW
         ========================= -->
        <section id="viewSingle" class="view is-active" role="tabpanel" aria-labelledby="tabSingle">
            <p class="muted">
                Chats not attached to a Project.
            </p>

            <div class="row">
                <label class="fieldInline">
                    <span>Limit</span>
                    <input id="singleLimit" type="number" inputmode="numeric" min="1" step="1" value="50" />
                </label>

                <button id="btnListSingle" type="button">List single chats</button>
                <span id="singleStatus" class="status">Idle</span>
            </div>

            <div class="row row--select">
                <label class="toggleAll">
                    <input id="cbSingleToggleAll" type="checkbox" />
                    Toggle all
                </label>
            </div>

            <div class="row row--danger">
                <button id="btnSingleDelete" type="button" class="danger">Delete selected (execute)</button>
            </div>

            <pre id="singleExecOut" class="report" aria-live="polite"></pre>

            <div id="singleExecProgressWrap" class="execProgressWrap" hidden>
                <progress id="singleExecProgress" value="0" max="100"></progress>
                <div id="singleExecProgressText" class="status"></div>
            </div>

            <div id="singleConfirmBox" class="confirmBox" hidden>
                <div class="confirmTitle" id="singleConfirmTitle"></div>
                <ul id="singleConfirmPreview" class="confirmPreview"></ul>

                <label class="confirm">
                    <input id="singleCbConfirm" type="checkbox" />
                    I understand this can’t be undone here.
                </label>

                <div class="row">
                    <button id="singleBtnConfirmExecute" type="button" class="danger">Yes, delete</button>
                    <button id="singleBtnCancelExecute" type="button">Cancel</button>
                </div>
            </div>

            <div class="summary">
                Found <span id="singleCount">0</span> · Selected: <span id="singleSelectedCount">0</span>
            </div>

            <ul id="singleList" class="list"></ul>
        </section>

        <!-- =========================
         PROJECTS VIEW
         ========================= -->
        <section id="viewProjects" class="view" role="tabpanel" aria-labelledby="tabProjects" hidden>
            <p class="muted">
                Projects and their conversations (API-based). No sidebar scraping.
            </p>

            <div class="row">
                <label class="fieldInline">
                    <span>Projects</span>
                    <input id="projectsLimit" type="number" inputmode="numeric" min="1" step="1" value="50" />
                </label>

                <label class="fieldInline">
                    <span>Chats per project</span>
                    <input id="projectsChatsLimit" type="number" inputmode="numeric" min="1" step="1" value="50" />
                </label>

                <button id="btnListProjects" type="button">List projects</button>
                <span id="projectsStatus" class="status">Idle</span>
            </div>

            <div class="row row--danger">
                <button id="btnProjectsDelete" type="button" class="danger">
                    Delete selected projects + chats (execute)
                </button>
            </div>

            <pre id="projectsExecOut" class="report" aria-live="polite"></pre>

            <div id="projectsChatsExecProgressWrap" class="execProgressWrap" hidden>
                <progress id="projectsChatsExecProgress" value="0" max="100"></progress>
                <div id="projectsChatsExecProgressText" class="status"></div>
            </div>

            <div id="projectsProjectsExecProgressWrap" class="execProgressWrap" hidden>
                <progress id="projectsProjectsExecProgress" value="0" max="100"></progress>
                <div id="projectsProjectsExecProgressText" class="status"></div>
            </div>


            <div id="projectsConfirmBox" class="confirmBox" hidden>
                <div class="confirmTitle" id="projectsConfirmTitle"></div>
                <ul id="projectsConfirmPreview" class="confirmPreview"></ul>

                <label class="confirm">
                    <input id="projectsCbConfirm" type="checkbox" />
                    I understand this can’t be undone here.
                </label>

                <div class="row">
                    <button id="projectsBtnConfirmExecute" type="button" class="danger">Yes, delete</button>
                    <button id="projectsBtnCancelExecute" type="button">Cancel</button>
                </div>
            </div>


            <div class="summary">
                Projects: <span id="projectsCount">0</span> (including <span id="projectsChatsCount">0</span> chats)
                · Selected chats: <span id="projectsSelectedChatsCount">0</span>
                · Selected projects: <span id="projectsSelectedProjectsCount">0</span>
            </div>


            <ul id="projectsList" class="list"></ul>
        </section>




        <!-- =========================
        SEARCH VIEW  
        ========================= -->
        <section id="viewSearch" class="view" role="tabpanel" aria-labelledby="tabSearch" hidden>
            <p class="muted">Search chats, filter, and bulk move results into projects.</p>

            <!-- TOP BAR -->
            <div class="row searchTopRow">
                <label class="sr-only" for="searchQuery">Search</label>
                <input id="searchQuery" type="search" placeholder="Search…" autocomplete="off" />

                <button id="btnSearchClear" type="button">Clear</button>
                <button id="btnSearchResetFilters" type="button" class="subtle">Reset filters</button>

                <!-- moved here from Info -->
                <button id="btnSearchListSingle" type="button" class="subtle">
                    List single
                </button>
                <button id="btnSearchListProjects" type="button" class="subtle">
                    List projects
                </button>
            </div>

            <!-- EXTRA FILTERS -->
            <details class="searchBox" id="searchExtra" role="group">
                <summary>Extra filters</summary>

                <div class="row searchFilters">
                    <label class="fieldInline">
                        <span>Scope</span>
                        <select id="searchScope">
                            <option value="all" selected>All</option>
                            <option value="single">Single</option>
                            <option value="projects">Projects</option>
                        </select>
                    </label>

                    <label class="fieldInline">
                        <span>Archived</span>
                        <select id="searchArchived">
                            <option value="include" selected>Include</option>
                            <option value="exclude">Exclude</option>
                            <option value="only">Only</option>
                        </select>
                    </label>

                    <label class="fieldInline">
                        <span>Updated</span>
                        <select id="searchUpdatedWithin">
                            <option value="any" selected>Any</option>
                            <option value="24h">24h</option>
                            <option value="7d">7d</option>
                            <option value="30d">30d</option>
                            <option value="1y">1y</option>
                        </select>
                    </label>

                    <label class="fieldInline">
                        <span>Created</span>
                        <select id="searchCreatedWithin">
                            <option value="any" selected>Any</option>
                            <option value="24h">24h</option>
                            <option value="7d">7d</option>
                            <option value="30d">30d</option>
                            <option value="1y">1y</option>
                        </select>
                    </label>
                </div>

                <div class="row searchFilters">
                    <label class="fieldInline">
                        <span>Updated after</span>
                        <input id="searchUpdatedAfter" type="date" />
                    </label>

                    <label class="fieldInline">
                        <span>Updated before</span>
                        <input id="searchUpdatedBefore" type="date" />
                    </label>

                    <label class="fieldInline">
                        <span>Created after</span>
                        <input id="searchCreatedAfter" type="date" />
                    </label>

                    <label class="fieldInline">
                        <span>Created before</span>
                        <input id="searchCreatedBefore" type="date" />
                    </label>
                </div>
            </details>

            <!-- INFO -->
            <details class="searchBox" id="searchInfoBox" role="group">
                <summary>Info</summary>

                <div class="searchInfoText muted">
                    Search works on the locally loaded cache.
                    Increase limits in <strong>Single</strong> or <strong>Projects</strong>, then list again.
                </div>

                <div class="searchInfoMeta">
                    <div>
                        Loaded:
                        <strong id="searchInfoLoadedSingles">0</strong> single ·
                        <strong id="searchInfoLoadedProjects">0</strong> projects ·
                        <strong id="searchInfoLoadedProjectChats">0</strong> project chats
                    </div>

                    <div class="muted" id="searchInfoLimits"></div>

                    <div>
                        Results: <strong id="searchResultsCount">0</strong>
                    </div>

                    <div id="searchStatus" class="muted"></div>
                </div>
            </details>

            <!-- RESULTS -->
            <ul id="searchResults" class="list"></ul>
        </section>


        <!-- =========================
        ORGANIZE VIEW (placeholder)
        ========================= -->
        <section id="viewOrganize" class="view" role="tabpanel" aria-labelledby="tabOrganize" hidden>
            <p class="muted">
                Move chats into projects. No destructive actions in this tab.
            </p>
            <div class="placeholder">
                Coming next: selection → destination → execute.
            </div>
        </section>


        <!-- =========================
LOGS VIEW
========================= -->
        <section id="viewLogs" class="view" role="tabpanel" aria-labelledby="tabLogs" hidden>
            <p class="muted">
                Audit log is always-on. Debug trace is optional and can be wiped instantly.
            </p>

            <!-- AUDIT -->
            <h3>Audit log</h3>

            <div class="row">
                <label class="fieldInline">
                    <span>Show</span>
                    <input id="logsLimit" type="number" inputmode="numeric" min="10" step="10" value="200" />
                </label>

                <button id="btnLogsRefresh" type="button">Refresh</button>
                <span id="logsStatus" class="status">Idle</span>
            </div>

            <div class="row">
                <label class="fieldInline">
                    <span>Trim keep last</span>
                    <input id="logsTrimKeep" type="number" inputmode="numeric" min="0" step="100" value="2000" />
                </label>

                <button id="btnLogsTrim" type="button">Trim</button>
                <button id="btnLogsExport" type="button">Export JSON</button>
                <button id="btnLogsClear" type="button" class="danger">Clear</button>
            </div>

            <pre id="logsOut" class="report" aria-live="polite"></pre>

            <!-- DEBUG TRACE -->
            <h3>Debug trace</h3>

            <div class="row">
                <label class="confirm" style="margin-right: auto;">
                    <input id="logsCbDebug" type="checkbox" />
                    Debug enabled (OFF wipes all debug traces)
                </label>

                <label class="fieldInline">
                    <span>Show</span>
                    <input id="debugLimit" type="number" inputmode="numeric" min="10" step="10" value="200" />
                </label>

                <button id="btnDebugRefresh" type="button">Refresh debug</button>
                <button id="btnDebugExport" type="button">Export debug JSON</button>
                <button id="btnDebugClear" type="button" class="danger">Clear debug</button>
                <span id="debugStatus" class="status">Idle</span>
            </div>

            <pre id="debugOut" class="report" aria-live="polite"></pre>
        </section>




        <!-- =========================
        STATS VIEW (placeholder)
        ========================= -->
        <section id="viewStats" class="view" role="tabpanel" aria-labelledby="tabStats" hidden>
            <p class="muted">
                Read-only overview of chats/projects and distribution.
            </p>
            <div class="placeholder">
                Coming next: totals, empty projects, large projects, etc.
            </div>
        </section>

    </div>

    <script type="module" src="../panel.js"></script>
</body>

</html>